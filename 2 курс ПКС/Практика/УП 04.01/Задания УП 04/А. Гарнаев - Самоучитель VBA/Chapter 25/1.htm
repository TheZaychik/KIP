<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML>
<HEAD>
<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=WINDOWS-1251">
<META NAME="GENERATOR" CONTENT="ABBYY FineReader 6.0">

</HEAD>

<body background=../FON.JPG>
      <ul>
<li><b><font face="Times New Roman" size=3><a href="#1">УРОК 10. ТЕМА: ЕЩЕ РАЗ О СОСТАВЛЕНИИ БАЗЫ ДАННЫХ</a></font></b> </li>
     <ul>
     <li><font face="Times New Roman" size=3><a href="#2">ЦЕЛЬ УРОКА</a></font> </li>
     <li><font face="Times New Roman" size=3><a href="#3">ПРАКТИКА</a></font> </li>
     <li><font face="Times New Roman" size=3><a href="#4">САМОСТОЯТЕЛЬНОЕ ЗАДАНИЕ</a></font> </li>

     </ul></ul>


<A NAME="1"></A>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><B>Урок 10</B>.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><font size="5">Тема:</font> 
  <font size="5">Еще раз о составлении </font></font><font face="Times New Roman, Times, serif" size="5">базы 
  данных</font><font face="Times New Roman, Times, serif" size="3"><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><B><font size="4"><a name="2"></a>Цель 
  урока</font></B><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">В разрабатываемом 
  в данном уроке приложении создается база данных туристической фирмы &quot;С 
  нами не соскучишься&quot; на рабочем листе с пользовательским интерфейсом и 
  средствами анализа, поиска и обработки информации, хранимой в базе данных. Предусмотрена 
  архивация и удаление выбранных записей базы данных.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">В процессе 
  разработки данного приложения вы на практике освоите:<BR>
  </font></P>
<ul>
  <li> <font face="Times New Roman, Times, serif" size="3"> Конструирование пользовательского 
    интерфейса<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Создание приложения, 
    работающего с несколькими диалоговыми окнами<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Поиск информации в 
    базе данных на рабочем листе<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Редактирование записей 
    в базе данных на рабочем листе<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Удаление ненужных записей 
    из базы данных на рабочем листе<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Архивацию данных на 
    рабочем листе<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Программирование фильтрации 
    данных<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Программирование сортировки 
    данных<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Программирование создания 
    сводных таблиц<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Построение диаграмм 
    по сводным таблицам<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Добавление пользователем 
    новых элементов в поле со списком во время выполнения программы<BR>
    </font></li>
</ul>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><B><font size="4"><a name="3"></a>Практика</font></B><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">В этом уроке 
  строится приложение с пользовательским интерфейсом по заполнению и обработке 
  базы данных туристической фирмы &quot;С нами не соскучишься&quot;. База данных 
  состоит из двух рабочих листов: БазаДанных (рис. У 10.1) и Архив (рис. У10.2). 
  Кроме того, при построении сводной таблицы по базе данных создается рабочий 
  лист своднаяТаблица.<BR>
  </font></P>
<P align="left"><img src="10.1.gif" width="528" height="459"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У10.1.</I></B><I> Рабочий лист БазаДанных</I><BR>
  </font></P>
<P align="left"><img src="10.2.gif" width="481" height="499"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У10.2. </I></B><I>Рабочий лист Архив</I><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">После загрузки 
  программа сама будет создавать свой интерфейс, отображать название окна приложения 
  и если на рабочих листах нет заголовков полей, то создавать их. Интерфейс программы 
  будет состоять из нескольких диалоговых окон.<BR>
  </font></P>
<div align="left">
  <TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="550" HEIGHT="474">
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="182" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="341" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="91" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="26"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="182" HEIGHT="26"> 
        <DIV WIDTH="182" HEIGHT="26"> 
          <P> <font face="Times New Roman, Times, serif" size="3"><B>Диалоговое 
            окно</B><BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="341" HEIGHT="26"> 
        <DIV WIDTH="341" HEIGHT="26"> 
          <P> <font face="Times New Roman, Times, serif" size="3"><B>Назначение</B><BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="91" HEIGHT="26"> 
        <DIV WIDTH="91" HEIGHT="26"> 
          <P> <font face="Times New Roman, Times, serif" size="3"><B>Форма</B><BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="26"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="74"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="182" HEIGHT="74"> 
        <DIV WIDTH="182" HEIGHT="74"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Регистрация 
            туристов фирмы &quot;С нами не соскучишься&quot; (рис. У10.3)<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="341" HEIGHT="74"> 
        <DIV WIDTH="341" HEIGHT="74"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Для заполнения 
            рабочего листа БазаДан-ных<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="91" HEIGHT="74"> 
        <DIV WIDTH="91" HEIGHT="74"> 
          <P> <font face="Times New Roman, Times, serif" size="3">UserForm1<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="74"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="208"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="182" HEIGHT="208"> 
        <DIV WIDTH="182" HEIGHT="208"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Поиск (рис. 
            У10.4)<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="341" HEIGHT="208"> 
        <DIV WIDTH="341" HEIGHT="208"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Производит поиск 
            клиента по фамилии. В фамилии клиента допустимо использовать символ 
            &lt;*&gt; вместо группы любых символов, символ &lt;?&gt; вместо любого 
            одного символа. В результате поиска, в случае отсутствия подходящих 
            клиентов выдается соответствующее сообщение. Если подходящие клиенты 
            найдены, в раскрывающемся списке выводится список их фамилий и имен. 
            Выбрав требуемого клиента и нажав кнопку Редактировать, пользователь 
            переходит к этапу редактирования информации о клиенте<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="91" HEIGHT="208"> 
        <DIV WIDTH="91" HEIGHT="208"> 
          <P> <font face="Times New Roman, Times, serif" size="3">UserForm3<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="208"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="106"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="182" HEIGHT="106"> 
        <DIV WIDTH="182" HEIGHT="106"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Перерегистрация 
            туристов фирмы &quot;С нами не соскучишься&quot; (рис. У1 0.5)<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="341" HEIGHT="106"> 
        <DIV WIDTH="341" HEIGHT="106"> 
          <P> <font face="Times New Roman, Times, serif" size="3">В него загружается 
            информация о найденном клиенте. Допустимо любое редактирование информации 
            с последующей заменой старой информации о клиенте на новую в базе 
            данных. Также возможна запись информации в архив и ее удаление из 
            базы данных.<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="91" HEIGHT="106"> 
        <DIV WIDTH="91" HEIGHT="106"> 
          <P> <font face="Times New Roman, Times, serif" size="3">UserForm2<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="106"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="60"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="182" HEIGHT="60"> 
        <DIV WIDTH="182" HEIGHT="60"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Фильтрация (рис. 
            У10.6)<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="341" HEIGHT="60"> 
        <DIV WIDTH="341" HEIGHT="60"> 
          <P> <font face="Times New Roman, Times, serif" size="3">В зависимости 
            от выбранного переключателя отображает только оплаченные или только 
            не оплаченные путевки.<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="91" HEIGHT="60"> 
        <DIV WIDTH="91" HEIGHT="60"> 
          <P> <font face="Times New Roman, Times, serif" size="3">UserForm4<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="60"> </TD>
    </TR>
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="182" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="341" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="91" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
  </TABLE>
</div>
<P align="left">&nbsp;</P>
<P align="left"><img src="10.3.gif" width="370" height="295"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У 10.3. </I></B><I>Диалоговое окно</I> </font><font face="Times New Roman, Times, serif" size="3"><I>Регистрация 
  туристов фирмы &quot;С нами не соскучишься&quot;</I><BR>
  </font></P>
<P align="left"><img src="10.4.gif" width="278" height="202"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У10.4. </I></B><I>Диалоговое окно Поиск</I><BR>
  </font></P>
<P align="left"><img src="10.5.gif" width="397" height="372"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У10.5. </I></B><I>Диалоговое окно Перерегистрация туристов фирмы &quot;С нами 
  не соскучишься&quot;</I><BR>
  </font></P>
<P align="left"><img src="10.6.gif" width="283" height="139"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У10.6. </I></B><I>Диалоговое окно Фильтрация</I><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Перейдем 
  к рассмотрению кнопок панели инструментов пользовательского меню.<BR>
  </font></P>
<div align="left">
  <TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="550" HEIGHT="405">
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="149" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="469" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="25"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="149" HEIGHT="25"> 
        <DIV WIDTH="149" HEIGHT="25"> 
          <P> <font face="Times New Roman, Times, serif" size="3"><B>Кнопка</B><BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="469" HEIGHT="25"> 
        <DIV WIDTH="469" HEIGHT="25"> 
          <P> <font face="Times New Roman, Times, serif" size="3"><B>Назначение</B><BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="25"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="42"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="149" HEIGHT="42"> 
        <DIV WIDTH="149" HEIGHT="42"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Регистрация<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="469" HEIGHT="42"> 
        <DIV WIDTH="469" HEIGHT="42"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Активизирует 
            диалоговое окно Регистрация туристов фирмы &quot;С нами не соскучишься&quot;<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="42"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="40"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="149" HEIGHT="40"> 
        <DIV WIDTH="149" HEIGHT="40"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Поиск и редактирование<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="469" HEIGHT="40"> 
        <DIV WIDTH="469" HEIGHT="40"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Активизирует 
            диалоговое окно Поиск<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="40"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="57"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="149" HEIGHT="57"> 
        <DIV WIDTH="149" HEIGHT="57"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Фильтр и его 
            отмена<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="469" HEIGHT="57"> 
        <DIV WIDTH="469" HEIGHT="57"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Создает в заголовках 
            полей базы данных раскрывающиеся списки со средствами фильтрации данных. 
            Повторное нажатие на кнопку удаляет эти списки<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="57"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="53"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="149" HEIGHT="53"> 
        <DIV WIDTH="149" HEIGHT="53"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Фильтрация оплаченных 
            путевок<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="469" HEIGHT="53"> 
        <DIV WIDTH="469" HEIGHT="53"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Активизирует 
            диалоговое окно Фильтрация<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="53"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="42"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="149" HEIGHT="42"> 
        <DIV WIDTH="149" HEIGHT="42"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Сортировка<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="469" HEIGHT="42"> 
        <DIV WIDTH="469" HEIGHT="42"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Сортирует данные 
            в алфавитном порядке по направлениям туров<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="42"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="58"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="149" HEIGHT="58"> 
        <DIV WIDTH="149" HEIGHT="58"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Сводная -таблица<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="469" HEIGHT="58"> 
        <DIV WIDTH="469" HEIGHT="58"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Создает на отдельном 
            рабочем листе сводную таблицу, в которой подсчитывает суммарную продолжительность 
            оплаченных и неоплаченных путевок по каждому из направлений туров<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="58"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="34"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="149" HEIGHT="34"> 
        <DIV WIDTH="149" HEIGHT="34"> 
          <P> <font face="Times New Roman, Times, serif" size="3">b<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="469" HEIGHT="34"> 
        <DIV WIDTH="469" HEIGHT="34"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Сохраняет данные 
            по принципу команды Сохранить (Save)<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="34"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="54"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="149" HEIGHT="54"> 
        <DIV WIDTH="149" HEIGHT="54"> 
          <P> <font face="Times New Roman, Times, serif" size="3">я<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="469" HEIGHT="54"> 
        <DIV WIDTH="469" HEIGHT="54"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Сохраняет данные 
            по принципу команды Сохранить как (Save as)<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="54"> </TD>
    </TR>
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="149" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="469" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
  </TABLE>
</div>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">В пользовательском 
  меню Файл имеются только три пункта: сохранить, сохранить как И Закрыть.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Перейдем 
  теперь к тексту программы. В своей структуре она имеет несколько модулей. Проанализируем 
  работу этой программы, последовательно обсудив каждый из ее модулей.<BR>
  </font></P>
<div align="left">
  <TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="550" HEIGHT="30">
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="160" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="459" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="30"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="160" HEIGHT="30"> 
        <DIV WIDTH="160" HEIGHT="30"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Модуль Модуль 
            1<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="459" HEIGHT="30"> 
        <DIV WIDTH="459" HEIGHT="30"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Описываются 
            переменные уровня проекта.<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="30"> </TD>
    </TR>
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="160" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="459" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
  </TABLE>
</div>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Option Explicit<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Public СписокНайденных 
  () As String<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Public Фамилия 
  As String </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' При поиске 
  клиента по фамилии в соответствии с используемым в приложении<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' алгоритмом 
  на длину фамилии не налагается ограничений </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Public Имя As 
  String * 20<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Public Пол As 
  String * 3<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Public ВыбранныйТур 
  As String * 20<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Public Оплачено 
  As String * 3</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> Public Фото 
  As String * 3</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> Public Паспорт 
  As String * 3 </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Public Срок As 
  String * 3 </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Public НомерСтроки 
  As Integer </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Public НайденнаяЗапись 
  As Integer </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Public Продолжительность 
  As Integer<BR>
  </font><font face="Times New Roman, Times, serif" size="3"> </font></P>
<div align="left">
  <TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="550" HEIGHT="292">
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="150" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="467" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="292"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="150" HEIGHT="292"> 
        <DIV WIDTH="150" HEIGHT="292"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Модуль<BR>
            </font></P>
          <P> <font face="Times New Roman, Times, serif" size="3">ThisWorkbook<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="467" HEIGHT="292"> 
        <DIV WIDTH="467" HEIGHT="292"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Создается пользовательское 
            меню и панели инструментов, а также заголовок окна пользовательского 
            приложения. Устанавливается связь между кнопками пользовательской 
            панели инструментов и процедурами модуля, которые инициализируют соответствующие 
            диалоговые окна или выполняют указанные действия. Устанавливается 
            режим работы, при котором весь пользовательский интерфейс прекращает 
            свое существование при закрытии приложения. Процедура workbook_WindowActivate 
            создает пользовательский интерфейс при загрузке книги. Процедура workbook 
            windowDeactivate восстанавливает интерфейс, используемый в окне рабочей 
            книги Excel по умолчанию.<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="292"> </TD>
    </TR>
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="150" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="467" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
  </TABLE>
</div>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  Workbook_WindowActivate(ByVal Wn As Excel.Window) </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  создания новой панели инструментов и новое меню при<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' открытии рабочей 
  книги </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' При открытии 
  рабочей книги панели инструментов Форматирование<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' и Стандартная 
  скрываются и отображается новый заголовок окна приложения<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With Application<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Caption = &quot;С 
  нами не соскучишься&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.DisplayAlerts 
  = False<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.CoirmandBars 
  (&quot;Formatting&quot;) .Visible = False<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.ContmandBars 
  (&quot;Standard&quot;) .Visible = False<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Создание новой 
  панели инструментов с именем<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Рабочая панель 
  инструментов, которая будет </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">' удаляться при 
  закрытии приложения </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With Application.CommandBars.Add(Nаmе:=&quot;Рабочая 
  панель инструментов&quot;, Position:=msoBarTop, MenuBar:=False, Temporary:=True)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Visible = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Controls<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Первая кнопка 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Add(Type:=msoContro!Button, 
  Id:=l)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Caption = &quot;Регистрация&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.TooltipText 
  = &quot;Регистрация клиентов&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Style = msoButtonCaption<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.OnAction = 
  &quot;Модуль1.UserForml_Initialize&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Вторая кнопка 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Add(Typef=msoControlButton, 
  Id:=l)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Caption = &quot;Поиск 
  и редактирование&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.TooltipText 
  = &quot;Поиск и редактирование&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Style = msoButtonCaption<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.OnAction = 
  &quot;Модуль1.UserForm3_Initialize&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Третья кнопка</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Add(Type:=msoControlButton, 
  Id:=l)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> .Caption = &quot;Фильтр 
  и его отмена&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.TooltipText 
  = &quot;Установка и снятие фильтра&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Style = msoButtonCaption 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.OnAction = &quot;Модуль1.Автофильтр&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Четвертая 
  кнопка </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Add{Type:=msoControlButton, 
  Id:=1)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Caption = &quot;Фильтрация 
  оплаченных путевок&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> .TooltipText 
  = &quot;Отображаются только оплаченные путевки&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> .Style = msoButtonCaption</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> .OnAction = 
  &quot;Модуль1.UserForm4_Initialize&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Пятая кнопка<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Add(Type:=msoControlButton, 
  Id:=l)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Caption = &quot;Сортировка&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.TooltipText 
  = &quot;Сортировка данных&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Style = msoButtonCaption<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.OnAction = 
  &quot;Модуль1.Сортировка&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End With</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Вторая панель 
  инструментов с именем Сводная таблица и файлы </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With Application.CommandBars.Add(Name:=&quot;Сводная 
  таблица и файлы&quot;, Position:=msoBarTop, MenuBar:=False, Temporary:=True)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Visible = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Controls 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">' <BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3"><I>' </I>Первая 
  кнопка </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Add(Type:=msoControlButton, 
  Id:=l) </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Caption = &quot;Сводная 
  таблица&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.TooltipText 
  = &quot;Построение сводной таблицы&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Style = msoButtonCaption 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.OnAction = &quot;Модуль1.СводнаяТаблица&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Вторая кнопка 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Add(Type:=msoControlButton, 
  Id:=3)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.TooltipText 
  = &quot;Сохранить&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.OnAction = 
  &quot;Модуль!.Запись&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Add(Type:=msoControlButton, 
  Id:=1175) </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.TooltipText 
  = &quot;Сохранить как&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.OnAction = &quot;Модуль1.СохранитьКак&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With Application.CommandBars.Add(Name:=&quot;МоеМеню&quot;, 
  MenuBar:=True, Temporary:=True) </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Visible = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Controls 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Создание строки 
  меню Файл<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Add(Type:=msoControlPopup) 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Caption = &quot;&amp;Файл&quot; 
  With .Controls<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Add(Type:=msoControlButton)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> .Caption = &quot;Сохранить&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.OnAction = &quot;Модуль1.Запись&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Add(Type:=msoControlButton)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> .Caption = &quot;Сохранить 
  как&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.OnAction = &quot;Модуль1.СохранитьКак&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With .Add(Type:=msoControlButton)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> .Caption = &quot;Закрыть&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.OnAction = &quot;Модуль1.Закрыть&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  Workbook_WindowDeactivate(ByVal Wn As Excel.Window)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура, 
  отображающая панели инструментов Форматирование<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' и Стандартная 
  при закрытии приложения<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Кроме того, 
  она устанавливает заголовок окна приложения, используемые<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' по умолчанию<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With Application<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.CommandBars(&quot;Formatting&quot;).Visible 
  = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.CoiranandBars(&quot;Standard&quot;).Visible 
  = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Caption = Empty</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub</font><font face="Times New Roman, Times, serif" size="3"><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Ранее при 
  описании модуль1 были указаны переменные уровня проекта, теперь рассмотрим несколько 
  его процедур.<BR>
  </font></P>
<div align="left">
  <TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="550" HEIGHT="535">
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="96" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="527" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="535"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="96" HEIGHT="535"> 
        <DIV WIDTH="96" HEIGHT="535"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Модуль<BR>
            </font></P>
          <P> <font face="Times New Roman, Times, serif" size="3">Модуль1<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="527" HEIGHT="535"> 
        <ul>
          <li> 
            <DIV WIDTH="527" HEIGHT="535"> <font face="Times New Roman, Times, serif" size="3"> 
              Процедура UserForm1_Initialize инициализирует диалоговое окно Регистрация 
              туристов фирмы &quot;С нами не соскучишься&quot;. Также при помощи 
              вызова процедуры заголовок-листа <I>в </I>ней создаются заголовки 
              полей базы данньгх на рабочем листе, в случае их отсутствия. </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="527" HEIGHT="535"><font face="Times New Roman, Times, serif" size="3">Процедура 
              UserForm3_Initialize активизирует диалоговое окно Поиск.<BR>
              </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="527" HEIGHT="535"><font face="Times New Roman, Times, serif" size="3">Процедура 
              userForm4_Initialize активизирует диалоговое окно Фильтрация.<BR>
              </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="527" HEIGHT="535"><font face="Times New Roman, Times, serif" size="3"> 
              Процедура сортировка упорядочивает данные по двум критериям: первоначальный 
              критерий направление тура, второстепенный — оплата </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="527" HEIGHT="535"><font face="Times New Roman, Times, serif" size="3"> 
              Процедура Своднаятаблица создает рабочий лист Сводная-таблица со 
              сводной таблицей (рис. У10.7). Столбцы сводной таблицы основаны 
              на поле оплачено; строки — на поле направление тура, а результаты 
              сводной таблицы подводятся суммированием по полю Продолжительность 
              базы данных. На основе сводной таблицы строится диаграмма. При этом 
              используется свойство TableRangel объекта PivotTable,<BR>
              возвращающее 
              диапазон с данными сводной таблицы, что позволяет избежать необходимости 
              явного описания диапазона, по которому строится диаграмма. </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="527" HEIGHT="535"><font face="Times New Roman, Times, serif" size="3"> 
              Процедура сохранитьКак активизирует встроенное диалоговое окно Сохранение 
              документа. </font></DIV>
          </li>
          <li>
            <DIV WIDTH="527" HEIGHT="535"><font face="Times New Roman, Times, serif" size="3">Процедура 
              закрыть закрывает приложение.<BR>
              </font></DIV>
          </li>
        </ul>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="535"> </TD>
    </TR>
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="96" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="527" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
  </TABLE>
  <p><img src="10.7.gif" width="489" height="539"></p>
</div>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У10.7. </I></B><I>Рабочий лист СводнаяТаблица</I><BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Public Sub UserForml_Initialize() 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3"><I>' </I>Процедура 
  активизации диалогового окна Регистрация туристов<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' и задание 
  элементов раскрывающегося списка</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Проверка наличия 
  заголовка базы данных.<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Построение 
  заголовка базы данных в случае его отсутствия<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If Sheets(&quot;БазаДанных&quot;).Range(&quot;Al&quot;).Value 
  &lt;&gt; &quot;Фамилия&quot; Then ЗаголовокЛиста<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End If</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Задание элементов 
  раскрывающегося списка</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With UserForml<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.CommandButtonl.Default 
  = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.CommandButton2.Cancel 
  = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.ComboBoxl.List 
  = Array(&quot;Лондон&quot;, &quot;Париж&quot;, &quot;Берлин&quot;)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.ComboBoxl.Listlndex 
  = 0 </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.OptionButtonl.Value 
  = True </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.SpinButtonl.Value 
  = 1</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> .CheckBoxl.Value 
  = False </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.CheckBox2.Value 
  = False </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.CheckBox3.Value 
  = False<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Активизация 
  диалогового окна </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">UserForml.Show 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Public Sub ЗаголовокЛиста()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With Sheets(&quot;БазаДанных&quot;)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;Al&quot;).Value 
  = &quot;Фамилия&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;Bl&quot;).Value 
  = &quot;Имя&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;Cl&quot;).Value 
  = &quot;Пол&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;Dl&quot;).Value 
  = &quot;Направление тура&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;El&quot;).Value 
  = &quot;Оплачено&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;Fl&quot;).Value 
  = &quot;Фото сданы&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;Gl&quot;).Value 
  = &quot;Паспорт сдан&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;HI&quot;).Value 
  = &quot;Продолжительность&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;A:A&quot;).ColumnWidth 
  = 9.43<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range (&quot;B:C&quot;) 
  .ColuimWidth = 8.43<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;D:D&quot;).ColumnWidth 
  = 13.43<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range'(&quot;E:E&quot;) 
  .ColumnWidth = 10.14<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;F:F&quot;).ColumnWidth 
  = 9<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;G:G&quot;).ColumnWidth 
  = 8.43<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;H:H&quot;).ColumnWidth 
  = 19.14<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Sheets(&quot;БазаДанных&quot;).Rows(&quot;1:1&quot;)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Select With 
  Selection<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Font.Bold = 
  True</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> .HorizontalAlignment 
  = xlGeneral </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.VerticalAlignment 
  = xlTop<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.WrapText = 
  True With .Interior<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Colorlndex 
  = 36<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Pattern = xlSolid</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End With</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Sheets(&quot;БазаДанных&quot;).Rows(&quot;2:2&quot;)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Select ActiveWindow.FreezePanes 
  = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Public Sub Запись 
  ()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveWorkbook.Save<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  UserForm3_Initialize() </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  активизации диалогового окна Поиск </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">UserFormS.Show 
  End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  Автофильтр()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  вызова команды Автофильтр </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Sheets(&quot;БазаДанных&quot;).Range(&quot;A1:H1&quot;).Select 
  Selection.AutoFilter</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  UserForm4_Initialize() </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  активизации диалогового окна фильтрации</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With UserForm4<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.OptionButtonl.Value 
  = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Show End With 
  End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  Сортировка() </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  сортировки данных<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Первоначальный 
  критерий сортировки - направление тура,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' второстепенный 
  - произведение оплаты<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim n Аs Integer 
  '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' n - вспомогательная 
  переменная '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Sheets(&quot;БазаДанных&quot;).Range(&quot;A2&quot;).Select<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">n = Selection. 
  CurrentRegion. Rows. Count '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Определение 
  числа записей в базе данных<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Worksheets(&quot;БазаДанных&quot;).Range(Cells(2, 
  1<I>),</I></font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Cells(n + 1, 
  8))</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Sort keyl—Worksheets(&quot;БазаДанных&quot;)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Range(&quot;D2&quot;), 
  orderl:=xlAscending, </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">key2:=Worksheets(&quot;БазаДанных&quot;).Range(&quot;E2&quot;),&quot; 
  _<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">order2:=xlDescending<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Сортировка 
  по турам в возрастающем,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' а по оплате 
  - в убывающем порядке </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  СводнаяТаблица () </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  построения сводной таблицы<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim n As Integer 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim Списки, 
  Назначение As String</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> Dim Лист As 
  Object</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> Dim ИмяКниги 
  As String<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ИмяКниги = ActiveWorkbook.Name<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Исключаем 
  расширение из имени книги '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">For i = 1 То 
  Len(ИмяКниги)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If Mid(ИмяКниги, 
  i, 1) = &quot;.&quot; Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ИмяКниги = Mid(ИмяКниги, 
  1, i - 1)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Exit For<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End If </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Next i</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> ИмяКниги = Trim(ИмяКниги)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Удаляются 
  ранее созданные рабочие листы с именем .СводнаяТаблица<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">For Each Лист 
  In Worksheets<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If Лист.Name 
  = &quot;СводнаяТаблица&quot; Then Sheets(&quot;СводнаяТаблица&quot;).Delete<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End If </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Next Лист<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Создается 
  новый рабочий лист с именем СводнаяТаблица</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Worksheets.Add<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveSheet.Name 
  = &quot;СводнаяТаблица&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">n = Worksheets(&quot;БазаДанных&quot;).Range(&quot;A2&quot;)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.CurrentRegion.Rows.Count</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Определение 
  диапазона, по которому будет строиться<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' сводная таблица 
  (Списки) и </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">где она будет 
  расположена (Назначение).<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Эти диапазоны 
  записываются в виде строковых выражений<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Списки = &quot;БазаДанных!R1C1:R&quot; 
  &amp; CStr(n) &amp; &quot;С8&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Назначение = 
  &quot;[&quot; &amp; ИмяКниги &amp; &quot;]СводнаяТаблица!R1C1&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Создание сводной 
  таблицы '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveSheet.PivotTableWizard 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">SourceType:=xlDatabase,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">SourceData:=Cписки, 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">TableDestination:=Hазвание, 
  ТаblеNаmе:=&quot;Отчет&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveSheet.PivotTables(&quot;Отчет&quot;).AddFields<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">RowFields:=&quot;Направление 
  тура&quot;, ColumnFields:=&quot;Оплачено&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> With ActiveSheet.PivotTables(&quot;Отчет&quot;)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.PivotFields(&quot;Продолжительность&quot;)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Orientation 
  = xlDataField<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Name = &quot;Сумма 
  по полю Продолжительность&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Function = 
  xlSum End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Построение 
  диаграммы по сводной таблице</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim СводнаяТаблица 
  As PivotTable<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim Диапазон 
  As Range<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Set СводнаяТаблица 
  = ActiveSheet.PivotTables(&quot;Отчет&quot;)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With ActiveSheet.PivotTables(&quot;Отчет&quot;)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' He отображаются 
  итоги по строкам и столбцам</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.RowGrand = 
  False .ColumnGrand = False<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Определение 
  диапазона из сводной таблицы,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' по которому 
  строится диаграмма </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Set Диапазон 
  = ActiveSheet.PivotTables(&quot;Отчет&quot;).TableRangel </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Построение 
  диаграммы<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Charts.Add<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveChart.ChartType 
  = xlColumnClustered<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveChart.SetSourceData 
  Source:=Диапазон,</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> PlotBy:=xlColumns<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveChart.Location 
  Where:=xlLocationAsObject, </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Name:=&quot;СводнаяТаблица&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With ActiveChart<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.HasTitle = 
  False<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Axes(xlCategory, 
  xlPrimary).HasTitle = False<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Axes(xlValue, 
  xlPrimary).HasTitle = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Axes(xlValue, 
  xlPrimary).AxisTitle.Characters.Text = _ </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">&quot;Продолжительность 
  оплаченных/неоплаченных поездок&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With</font><font size="3" face="Courier New, Courier, mono"><BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Sub СохранитьКак() 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  активизирует встроенное окно Сохранение документа<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Application.Dialogs(xlDialogSaveAs).Show<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Sub Закрыть() 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  закрытия приложения </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Application,Quit</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End Sub</font><font face="Times New Roman, Times, serif" size="3"><BR>
  </font></P>
<div align="left">
  <TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="550" HEIGHT="353">
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="115" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="500" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="353"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="115" HEIGHT="353"> 
        <DIV WIDTH="115" HEIGHT="353"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Модуль<BR>
            </font></P>
          <P> <font face="Times New Roman, Times, serif" size="3">UserForml<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="500" HEIGHT="353"> 
        <DIV WIDTH="500" HEIGHT="353"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Программа считывает 
            информацию с диалогового окна Регистрация туристов фирмы &quot;С нами 
            не соскучишься&quot; (рис. У 10.3) и обеспечивает ввод набранных в 
            нем данных в рабочий лист БазаДанных. </font></P>
        </DIV>
        <ul>
          <li> 
            <DIV WIDTH="500" HEIGHT="353"><font face="Times New Roman, Times, serif" size="3"> 
              Нажатие кнопки ок активизирует процедуру CommandButton1_Click по 
              считыванию информации с диалогового окна и заполнению базы данных. 
              </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="500" HEIGHT="353"><font face="Times New Roman, Times, serif" size="3"> 
              Счетчик активизирует процедуру SpinButton1_Change, которая вводит 
              значения счетчика в поле продолжительность тура.<BR>
              </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="500" HEIGHT="353"> <font face="Times New Roman, Times, serif" size="3"> 
              Процедура TextBox3_Change синхронизирует вводимые данные в поле 
              продолжительность тура со значением счетчика. </font></DIV>
          </li>
          <li>
            <DIV WIDTH="500" HEIGHT="353"><font face="Times New Roman, Times, serif" size="3"> 
              Нажатие кнопки Отмена активизирует процедуру CommandButton2_Сlick, 
              которая закрывает диалоговоеокно Регистрация туристов фирмы &quot;С 
              нами не соскучишься&quot; . <BR>
              </font></DIV>
          </li>
        </ul>
        <DIV WIDTH="500" HEIGHT="353">
          <P> <font face="Times New Roman, Times, serif" size="3"><BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="353"> </TD>
    </TR>
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="115" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="500" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
  </TABLE>
</div>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButtonl_Click()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' В переменную 
  НомерСтроки вводится номер первой пустой строки </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">' рабочего листа 
  БазаДанных<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">НомерСтроки 
  = Application.CountA(Sheets(&quot;БазаДанных&quot;).Range(&quot;A:A&quot;)) 
  + I </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Считывание 
  информации в переменные из диалогового окна<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With UserForml<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Фамилия = .TextBoxl.Text 
  Имя = .TextBox2.Text </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Продолжительность 
  = .TextBox3.Text</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> If .OptionButtonl.Value 
  = True Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Пол = &quot;Муж&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> Else<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Пол = &quot;Жен&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End If</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> If ..CheckBoxl.Value 
  = True Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Оплачено = &quot;Да&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> Else<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Оплачено = &quot;Нет&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End If</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> If .CheckBox2.Value 
  = True Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Фото'= &quot;Да&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Else<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Фото = &quot;Нет&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End If </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">If .CheckBoxS 
  = xlOn Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Паспорт = &quot;Да&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Else<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Паспорт = &quot;Нет&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End </font><font face="Courier New, Courier, mono" size="3">If 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">ВыбранныйТур 
  = .ComboBoxl.Text<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Запись данных 
  на рабочий лист БазаДанных</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With Sheets(&quot;БазаДанных&quot;)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НомерСтроки, 
  1).Value = Фамилия<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НомерСтроки, 
  2).Value = Имя<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НомерСтроки, 
  3).Value = Пол<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НомерСтроки, 
  4).Value = ВыбранныйТур<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НомерСтроки, 
  5).Value = Оплачено<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НомерСтроки, 
  6).Value = Фото<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НомерСтроки, 
  7).Value = Паспорт<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НомерСтроки, 
  8).Value = Продолжительность </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButton2_Click() </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  закрытия диалогового окна UserForml.Hide<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  SpinButtonl_Change()</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  .ввода числа со счетчика в поле ввода</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With UserForml<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.TextBoxS.Text 
  = CStr(.SpinButtonl.Value</font><font face="Courier New, Courier, mono" size="3">) 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  TextBox3_Change()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  установки значения счетчика из поля ввода<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With UserForml<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.SpinButtonl.Value 
  = CInt(.TextBox3.Text) </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub</font><font face="Times New Roman, Times, serif" size="3"><BR>
  </font></P>
<div align="left">
  <TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="550" HEIGHT="141">
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="114" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="499" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="141"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="114" HEIGHT="141"> 
        <DIV WIDTH="114" HEIGHT="141"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Модуль<BR>
            </font></P>
          <P> <font face="Times New Roman, Times, serif" size="3">UserForm3<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="499" HEIGHT="141"> 
        <DIV WIDTH="499" HEIGHT="141"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Программа ищет 
            по фамилии, введенной в поле Фамилия диалогового окна поиск (рис. 
            У10.4), подходящих клиентов в базе данных. Если такие имеются, то 
            список вариантов найденных клиентов в базе данных с указанием фамилий, 
            имен и номеров записей, отображается в раскрывающемся списке Найденные 
            варианты. В противном случае выдается сообщение о неудачном поиске 
            (рис. У10.8).</font></P>
        </DIV>
        <ul>
          <li> 
            <DIV WIDTH="499" HEIGHT="141"><font face="Times New Roman, Times, serif" size="3"> 
              Нажатие кнопки поиск активизирует процедуру CommandButton1_Click, 
              которая производит поиск клиентов и отображает список найденных 
              вариантов. </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="499" HEIGHT="141"><font face="Times New Roman, Times, serif" size="3"> 
              Нажатие кнопки Редактировать активизирует процедуру CommandButton2_Click, 
              которая закрывает диалоговое окно поиск и активизирует диалоговое 
              окно перерегистрация туристов фирмы &quot;С нами не соскучишься&quot; 
              (рис. У10.5), заполняя его информацией о выбранном клиенте. </font></DIV>
          </li>
          <li>
            <DIV WIDTH="499" HEIGHT="141"><font face="Times New Roman, Times, serif" size="3"> 
              Нажатие кнопки отмена активизирует процедуру CommandButton3_Click, 
              которая закрывает диалоговое окно Поиск.<br>
              <BR>
              </font></DIV>
          </li>
        </ul>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="141"> </TD>
    </TR>
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="114" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="499" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
  </TABLE>
  
</div>
<P align="left">&nbsp;</P>
<P align="left"><img src="10.8.gif" width="369" height="125"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У10.8. </I></B><I>Сообщение о неудачном поиске клиента</I><BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButtonl_Click()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  поиска клиента<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim i As Integer 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Dim j As Integer</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> Dim n As Integer<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim Строка As 
  Integer </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' i ,j и n - 
  вспомогательные переменные<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' В переменной 
  i перебираются номера строк из базы данных,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' начиная со 
  второй и заканчивая последней непустой строкой,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' номер которой 
  определен в переменной Строка.<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Переменная 
  j выполняет роль счетчика,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' учитывающего 
  текущее количество отобранных вариантов.<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Если отобранных 
  вариантов нет, то j присваивается 0.<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' n присваивается 
  конечному значению счетчика j<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim Тест As 
  String<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Тест - вспомогательная 
  переменная, в которую вводится очередная<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' проверяемая 
  фамилия </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim СписокНайденных() 
  As String<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Строка = Application.CountA(Sheets(&quot;БазаДанных&quot;).Columns(1)}<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Фамилия = UserForm3.TextBoxl.Text<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">i = 2<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">j = 0<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Do While i &lt;= 
  Строка<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Тест = Sheets(&quot;БазаДанных&quot;).Cells 
  (i, 1).Text<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If IsNumeric(Application.Search(Фамилия, 
  Тест)) = True Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">j = j + 1</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End If<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">i = i + 1 </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Loop </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">If j = 0 Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Вышла 
  промашка. А клиента таково и в помине нет.&quot;,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">vbExclamation, 
  &quot;Поиск&quot; НайденнаяЗапись = 0 </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Exit Sub </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End </font><font face="Courier New, Courier, mono" size="3">If</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> n = j</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">ReDim СписокНайденных(1 
  To n, 0 To 2) As String<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Двумерный 
  динамический массив СписокНайденных используется для заполнения<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' раскрывающегося 
  списка с возможными вариантами клиентов.<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Первый и второй 
  столбцы массива содержат фамилию и имя клиента,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' а третий - 
  номера строки из рабочего листа БазаДанных,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' в которой 
  записана информация о клиенте<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3"><I>'</I><BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">i = 2<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">j = 0<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Do While i &lt;= 
  Строка<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Тест = Sheets(&quot;БазаДанных&quot;).Cells(i, 
  1).Text<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If IsNumeric(Application.Search(Фамилия, 
  Тест)) = True Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">j = j + 1<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">СписокНайденных(j, 
  0} = Тест<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">СписокНайденных(j, 
  1) = Sheets(&quot;БазаДанных&quot;).Cells(i, 2).Text<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">СписокНайденных(j 
  , 2) = CStr(i)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End If</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> i = i + 1<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Loop </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Заполнение 
  раскрывающегося списка<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With UserForm3.ComboBoxl<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Clear<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.ColumnHeads 
  = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.ColumnCount 
  = 3<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.ColumnWidths 
  = &quot;60;60;10&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.List = СписокНайденных()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Listlndex = 
  0 </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Ввод в переменную 
  НайденнаяЗапись номера строки с<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' первым клиентом, 
  выведенным в раскрывающийся список</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">НайденнаяЗапись 
  = CInt(СписокНайденных(1, 2))</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButton2_Click() </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  закрытия диалогового окна Поиск,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' открытия диалогового 
  окна Перерегистрация туристов<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' и заполнением 
  его информацией о найденном туристе </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Закрывается 
  диалоговое окно Поиск<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">UserForm3.Hide 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim n As Integer</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' n - вспомогательная 
  переменная, используемая для<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' ввода из базы 
  данных в раскрывающийся список<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' направления 
  тура найденного клиента<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' (считывается 
  из раскрывающегося списка<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' номер строки 
  выбранного клиента)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">НайденнаяЗапись 
  = UserForm3.ComboBoxl. List(UserForm3.ComboBoxl.Listlndex, 2)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Если клиент 
  не найден, то процедура информирует об этом,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' напоминая, 
  что перед редактированием должен быть найден клиент</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If НайденнаяЗапись 
  = 0 Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Сначала 
  надо найти клиента&quot;, vblnformation, &quot;Редактирование&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Exit Sub </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End If<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Ввод из базы 
  данных в диалоговое окно Редактирование<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' информации 
  о найденном клиенте </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With UserForm2<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.TextBoxl:Text 
  = Sheets(&quot;БазаДанных&quot;)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Cells(НайденнаяЗапись, 
  1)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Value .TextBox2.Text 
  = Sheets(&quot;БазаДанных&quot;)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Cells(НайденнаяЗапись, 
  2).Value </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.TextBox3.Text 
  = Sheets(&quot;БазаДанных&quot;)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Cells(НайденнаяЗапись, 
  8).Value </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">If Sheets(&quot;БазаДанных&quot;).Cells(НайденнаяЗапись, 
  3)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Value = &quot;Муж&quot; 
  Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.OptionButtonl.Value 
  = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.OptionButton2.Value 
  = False Else<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.OptionButtonl.Value 
  = False<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.OptionButton2.Value 
  = True End If If Sheets(&quot;БазаДанных&quot;)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Cells(НайденнаяЗапись, 
  5)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Value = &quot;Да&quot; 
  Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.CheckBoxl.Value 
  = True Else<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.CheckBoxl.Value 
  = False</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End If<I> </I></font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">If Sheets(&quot;БазаДанных&quot;).Cells(НайденнаяЗапись, 
  6)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Value = &quot;Да&quot; 
  Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.CheckBox2.Value 
  = True Else<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.CheckBox2.Value 
  = False<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End If<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If Sheets(&quot;БазаДанных&quot;).Cells(НайденнаяЗапись, 
  7)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Value = &quot;Да&quot; 
  Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.CheckBox3.Value 
  = True </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Else<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.CheckBox3.Value 
  - False </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End If<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.ComboBoxl.List 
  = Array(&quot;Афины&quot;, &quot;Берлин&quot;, &quot;Лондон&quot;) </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">ВыбранныйТур 
  = Cells(НайденнаяЗапись, 4)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Value Select 
  Case ВыбранныйТур Case Is = &quot;Афины&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">n = 0 Case Is 
  = &quot;Берлин&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">n = 1 Case Is 
  = &quot;Лондон&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">n = 2<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Select<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.ComboBoxl.Listlndex 
  = n .Show </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CortroandButton3_Click () </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  закрытия диалогового окна </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">UserForm3.Hide 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End Sub</font><font face="Times New Roman, Times, serif" size="3"><BR>
  </font></P>
<div align="left">
  <TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="550" HEIGHT="210">
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="114" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="501" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="210"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="114" HEIGHT="210"> 
        <DIV WIDTH="114" HEIGHT="210"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Модуль<BR>
            </font></P>
          <P> <font face="Times New Roman, Times, serif" size="3">UserForm2<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="501" HEIGHT="210"> 
        <ul>
          <li> 
            <DIV WIDTH="501" HEIGHT="210"> <font face="Times New Roman, Times, serif" size="3"> 
              Нажатие кнопки Запись в архив активизирует процедуру CommandButton1_Click, 
              которая из диалогового окнаПеререгистрация туристов фирмы &quot;С 
              нами не соскучишься&quot; (рис. У10.5) вводит данные на рабочий 
              лист Архив.</font></DIV>
          </li>
          <li>
            <DIV WIDTH="501" HEIGHT="210">
              <DIV WIDTH="501" HEIGHT="210"><font face="Times New Roman, Times, serif" size="3"> 
                Нажатие кнопки отмена активизирует процедуру ConmandButton2_Click, 
                закрывающую диалоговое окно. </font></DIV>
            </DIV>
          </li>
          <li> 
            <DIV WIDTH="501" HEIGHT="210"><font face="Times New Roman, Times, serif" size="3"> 
              Нажатие кнопки Удалить активизирует процедуру CommandButton3_Click, 
              которая удаляет запись из базы данных.</font></DIV>
          </li>
          <li> 
            <DIV WIDTH="501" HEIGHT="210"><font face="Times New Roman, Times, serif" size="3"> 
              Нажатие кнопки Ввести изменения активизирует процедуру commandButton4 
              click, которая вводит внесенные : изменения в запись базы данных.<BR>
              </font></DIV>
          </li>
        </ul>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="210"> </TD>
    </TR>
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="114" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="501" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
  </TABLE>
  
</div>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButtonl_Click() </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  записи на рабочий лист Архив<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim Строка As 
  Integer '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Строка - вспомогательная 
  переменная, которой присваивается </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">' номер первой 
  пустой строки рабочего листа Архив<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Копирование 
  строки из рабочего листа БазаДанных в буфер обмена </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Sheets(&quot;БазаДанных&quot;}.Rows(НайденнаяЗапись).Сору</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Вставка в 
  рабочий лист Архив содержания буфера обмена<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With Sheets(&quot;Архив&quot;)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Строка-= Application.CountA(.Columns(1)) 
  + 1 </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Paste Destination:=.Rows(Строка) 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButton2_Click()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Закрытие диалогового 
  окна Редактирование<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">UserForm2.Hide 
  ' Обнуляется номер найденной записи<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">НайденнаяЗапись 
  = 0</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButton3_Click() </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  удаления строки из рабочего листа БазаДанных<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">НайденнаяЗапись 
  = Sheets(&quot;БазаДанных&quot;).Cells(1, 20).Value<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Удаление записи 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Sheets(&quot;БазаДанных&quot;).Rows(НайденнаяЗапись).Select<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Selection.Delete 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Закрытие диалогового 
  окна Редактирование</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">UserForm2.Hide 
  '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Обнуление 
  переменной с номером строки<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">НайденнаяЗапись 
  = 0<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Sheets(&quot;БазаДанных&quot;).Cells(1, 
  20).Value = Empty<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButton4_Click() </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  записи в базу данных измененной информации</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Считывание 
  информации из диалогового окна &quot;Редактирование&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> ' в переменные<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With UserForm2<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Фамилия = .TextBoxl.Text<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Имя = .TextBox2.Text<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Продолжительность 
  = CInt(.TextBox3.Text) </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">If .OptionButtonl.Value 
  = True Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Пол = &quot;Муж&quot; 
  Else<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Пол = &quot;Жен&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End If </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">If .CheckBoxl.Value 
  = True Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Оплачено = &quot;Да&quot; 
  Else<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Оплачено = &quot;Нет&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End If</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> If .CheckBox2.Value 
  = True Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Фото = &quot;Да&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Else<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Фото = &quot;Нет&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End If </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">If .CheckBoxS.Value 
  = True Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Паспорт = &quot;Да&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Else<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Паспорт = &quot;Нет&quot; 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End If<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ВыбранныйТур 
  = .ComboBoxl.Text </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">НайденнаяЗапись 
  = Sheets(&quot;БазаДанных&quot;) .Cells (1, 20).Value '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Запись редактируемой 
  информации о клиенте в базу данных<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With Sheetst&quot;БазаДанных&quot;)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НайденнаяЗапись, 
  1)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Value = Фамилия<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НайденнаяЗапись, 
  2)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Value = Имя<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НайденнаяЗапись, 
  3)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Value = Пол<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НайденнаяЗапись, 
  4)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Value = ВыбранныйТур<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НайденнаяЗапись, 
  5)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Value = Оплачено<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НайденнаяЗапись, 
  6)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Value = Фото<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НайденнаяЗапись, 
  7)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Value = Паспорт<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cells(НайденнаяЗапись, 
  8)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Value = Продолжительность<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  SpinButtonl_Change()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">TextBox3.Text 
  = CStr(SpinButtonl.Value) </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End Sub</font><font face="Times New Roman, Times, serif" size="3"><BR>
  </font></P>
<div align="left">
  <TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="550" HEIGHT="166">
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="114" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="498" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="166"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="114" HEIGHT="166"> 
        <DIV WIDTH="114" HEIGHT="166"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Модуль<BR>
            </font></P>
          <P> <font face="Times New Roman, Times, serif" size="3">UserForm4<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="498" HEIGHT="166"> 
        <ul>
          <li> 
            <DIV WIDTH="498" HEIGHT="166"> <font face="Times New Roman, Times, serif" size="3"> 
              Нажатие кнопки Фильтрация диалогового окна Фильтрация (рис. У10.6) 
              активизирует процедуру CommandButton1_Click, которая производит 
              фильтрацию данных из базы данных в зависимости от выбранного критерия 
              фильтрации в группе Путевка . </font></DIV>
          </li>
          <li>
            <DIV WIDTH="498" HEIGHT="166"><font face="Times New Roman, Times, serif" size="3"> 
              Нажатие кнопки Отмена активизирует процедуру CommandButton2_Сlick, 
              которая закрывает диалоговое окно Фильтрация.<BR>
              </font></DIV>
          </li>
        </ul>
        <DIV WIDTH="498" HEIGHT="166">
          <P><font face="Times New Roman, Times, serif" size="3"><BR>
            </font></P>
          <P> <font face="Times New Roman, Times, serif" size="3"><BR>
            </font></P>
          <P> <font face="Times New Roman, Times, serif" size="3"><BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="166"> </TD>
    </TR>
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="2"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="114" HEIGHT="2"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="498" HEIGHT="2"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="2"> </TD>
    </TR>
  </TABLE>
</div>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButtonl_Click() </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">' Процедура фильтрации 
  по критерию </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Dim Flag As String<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Flag устанавливает 
  критерий фильтрации по третьему столбцу</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Sheets(&quot;БазаДанных&quot;).Rows(1).Select 
  Selection.AutoFilter<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With UserForm4<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If .OptionButtonl.Value 
  = True Then Flag = &quot;Да&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If .OptionButton2.Value 
  = True Then Flag = &quot;Нет&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Считывание 
  критерия из диалогового окна для фильтрации<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Sheets(&quot;БазаДанных&quot;).Rows(l).Select 
  Selection.AutoFilter<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Selection.AutoFilter 
  Field:=5, Criteria1:=Flag </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Фильтрация 
  по критерию </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButton2_Click()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Закрытие диалогового 
  окна Фильтрация<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">UserForm4.Hide 
  End Sub<BR>
  </font><font face="Times New Roman, Times, serif" size="3"> </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><B><font size="4"><a name="4"></a>Самостоятельное 
  задание</font></B><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Построить 
  приложение, учитывающее движение товара на складе магазина &quot;Все, чего душа 
  пожелает&quot;. В диалоговом окне приема товара на склад (рис. У10.9) предусмотреть 
  ввод наименования товара, цену, количество, дату приема и единицу измерения 
  товара. Поступающие товары должны записываться в базу данных рабочего листа 
  Склад.<BR>
  </font></P>
<P align="left"><img src="10.9.gif" width="304" height="278"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У10.9. </I></B><I>Диалоговое окно Все, чего душа пожелает. Прием товара.</I><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Единицу измерения 
  товара следует вводить при помощи раскрывающегося списка. Первоначально, в списке 
  задать две единицы измерения: кг и штук. При появлении товара с новой единицей 
  измерения, например литр, первый раз эта единица измерения вводится в раскрывающийся 
  список вручную, после чего программа должна автоматически расширить список используемых 
  единиц измерения, добавив в него введенную величину.<BR>
  </font></P>
<P align="left"><img src="10.10.gif" width="489" height="539"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У10.10. </I></B><I>Автоматическое расширение элементов раскрывающегося списка</I><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Предусмотреть 
  в приложении средства поиска товара. При продаже товара записывать информацию 
  о проданном товаре в базу данных, хранящуюся на рабочем листе продано. При списании 
  товара записывать информацию о нем в базу данных, хранящуюся на рабочем листе 
  Списание. Обеспечить программную фильтрацию, сортировку данных и построение 
  обобщающих сводных таблиц как по проданным, так и по списанным и находящимся 
  еще на складе товарам.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Следующая 
  процедура является примером того, как можно автоматически добавлять в раскрывающийся 
  список новые элементы. В диапазон A1:А2 рабочего листа, на основе которого строится 
  раскрывающийся список, введем кг и штук (рис. У10.10). При вводе в поле раскрывающегося 
  списка нового элемента, отличного от предыдущих, и нажатии кнопки CommandButton1, 
  этот элемент программно вводится в ячейку АЗ. Теперь раскрывающийся список автоматически 
  будет строиться по диапазону A1 : АЗ и т. д.<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButtonl_Click()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim Диапазон 
  As String </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Диапазон, 
  на основе которого строится поле со списком </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim n, i As 
  Integer</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' n - число 
  элементов в диапазоне </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim Новый As 
  String<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Новый - .элемент, 
  вводимый в поле со списком<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">n = Application.CountAfRange(&quot;A:A&quot;))<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Новый = ComboBoxl.Text<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Проверка, 
  совпадает ли элемент, вводимый в поле со списком, </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">' с каким-либо 
  элементом списка. Если не совпадает, то<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' он добавляется 
  в конец диапазона, по которому строится список </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If ComboBoxl.MatchFound 
  = False Then </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Cells(n + 1, 
  .1).Value = Новый </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Диапазон = &quot;A1:A&quot; 
  &amp; CStr(n + 1)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ComboBox1.RowSource 
  = Диапазон</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End If<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  UserForm_Initialize()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim Диапазон 
  As String<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim n As Integer<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">n = Application.CountA(Range(&quot;A:A&quot;))</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> Диапазон = &quot;A1:A&quot; 
  &amp; CStr(n)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> ComboBoxl.RowSource 
  = Диапазон </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">UserForml.Show<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub</font><font face="Times New Roman, Times, serif" size="3"><BR>
  </font></P>
</BODY>
</HTML>

