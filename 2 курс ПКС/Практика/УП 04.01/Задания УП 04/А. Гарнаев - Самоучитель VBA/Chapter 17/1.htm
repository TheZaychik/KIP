<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML>
<HEAD>
<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=WINDOWS-1251">
<META NAME="GENERATOR" CONTENT="ABBYY FineReader 6.0">

</HEAD>

<body background=../FON.JPG>
      <ul>
<li><b><font face="Times New Roman" size=3><a href="#1">УРОК 2. ТЕМА: РАСЧЕТ МАРГИНАЛЬНОЙ ПРОЦЕНТНОЙ СТАВКИ</a></font></b> </li>
     <ul>
     <li><font face="Times New Roman" size=3><a href="#2">ЦЕЛЬ УРОКА</a></font> </li>
     <li><font face="Times New Roman" size=3><a href="#3">ТЕОРИЯ</a></font> </li>
     <li><font face="Times New Roman" size=3><a href="#4">ПРАКТИКА</a></font> </li>
     <li><font face="Times New Roman" size=3><a href="#5">САМОСТОЯТЕЛЬНОЕ ЗАДАНИЕ</a></font> </li>

     </ul></ul>


<A NAME="1"></A>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><B>Урок 2</B><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><font size="5">Тема:</font></font> 
  <font face="Times New Roman, Times, serif" size="5">Расчет маргинальной</font> 
  <font face="Times New Roman, Times, serif" size="5">процентной ставки</font><font face="Times New Roman, Times, serif" size="3"><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><B><font size="4"><a name="2"></a>Цель 
  урока</font></B><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">В уроке разрабатывается 
  приложение, решающее задачу расчета маргинальной процентной ставки при постоянных 
  выплатах в течение согласованного срока. Конструируя данное приложение, вы освоите:<BR>
  </font></P>
<ul>
  <li> <font face="Times New Roman, Times, serif" size="3">Как при помощи метода 
    Goaiseek решаются уравнения<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Программный ввод формулы 
    в ячейку рабочего листа<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Применение финансовой 
    функции пз (PV)<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Проверку корректности 
    ввода данных из диалогового окна<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Назначение клавишам 
    &lt;Enter&gt; и &lt;Esc&gt; функций кнопок диалогового окна<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Назначение кнопкам 
    всплывающих подсказок<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Использование MacroRecorder 
    для упрощения и ускорения написания кода<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Программное форматирование 
    ячеек рабочего листа<BR>
    </font></li>
</ul>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><B><font size="4"><a name="3"></a>Теория</font></B><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Рассматриваемое 
  приложение решает задачу следующего типа. В одной стране со стабильной валютой, 
  скажем рублем, жил-был Ксенофон Заковыркин, начинающий бизнесмен. Однажды ему 
  была предложена следующая сделка. Ксенофон дает в долг 10 000 руб., а ему возвращают 
  по 2 000 руб. в течение 6 последующих лет, т. е. в сумме 12 000 руб., что больше 
  даваемой в долг суммы денег. Ксенофон Заковыркин может не давать эти деньги 
  в долг, а положить под проценты в банк. Спрашивается: при какой минимальной 
  процентной ставке более выгодно класть деньги под проценты, чем давать в долг 
  на данных условиях? Чему равен текущий объем вклада при годовой ставке 7%?<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Первоначально 
  немного поговорим о финансовых понятиях, упомянутых в задаче, с которой столкнулся 
  Ксенофон Заковыркин.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Маргинальной 
  процентной ставкой является максимальная процентная ставка, при которой предлагаемая 
  сделка более выгодна, чем просто положить деньги под проценты.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Для решения 
  этой задачи воспользуемся понятием текущий объем вклада. Текущий объем вклада 
  — это сегодняшний объем будущих платежей (отрицательные значения) и поступлений 
  (положительные значения). Например, вам предлагают следующую сделку. У вас берут 
  в долг некоторую сумму денег и предлагают через <I>k<SUB>1</SUB> </I>год вернуть 
  <I>Рk<SUB>1</SUB></I>денег, через <I>k</I><SUB>2</SUB> года вернуть <I>Рk<SUB>2</SUB> 
  </I>денег и т. д., через <I>k<SUB>n</SUB> </I>лет вернуть<I> Pk<SUB>n</SUB></I> 
  денег. Кроме данной сделки у </font><font face="Times New Roman, Times, serif" size="3">вас 
  есть альтернативный способ использования ваших денег, например положить их в 
  банк под i% годовых. Тогда текущим объемом вклада является та сумма денег, которой 
  вы должны располагать в текущем году, чтобы положив их в банк под i% годовых, 
  вы получили предлагаемую вам прибыль.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Текущий объем 
  вклада на основе постоянных периодических платежей в течение согласованного 
  срока возвращает финансовая функция рабочего листа пз (PV) .<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Синтаксис:<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ПЗ(ставка; кпер; 
  выплата; бз; тип)</font><font face="Times New Roman, Times, serif" size="3"><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Аргументы:<BR>
  </font></P>
<div align="left"> 
  <TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="550" HEIGHT="228">
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="127" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="489" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="26"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="127" HEIGHT="26"> 
        <DIV WIDTH="127" HEIGHT="26"> 
          <P> <font face="Times New Roman, Times, serif" size="3">ставка<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="489" HEIGHT="26"> 
        <DIV WIDTH="489" HEIGHT="26"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Процентная ставка 
            за период<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="26"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="26"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="127" HEIGHT="26"> 
        <DIV WIDTH="127" HEIGHT="26"> 
          <P> <font face="Times New Roman, Times, serif" size="3">кпер<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="489" HEIGHT="26"> 
        <DIV WIDTH="489" HEIGHT="26"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Общее число 
            периодов выплат<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="26"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="26"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="127" HEIGHT="26"> 
        <DIV WIDTH="127" HEIGHT="26"> 
          <P> <font face="Times New Roman, Times, serif" size="3">выплата<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="489" HEIGHT="26"> 
        <DIV WIDTH="489" HEIGHT="26"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Величина постоянных 
            периодических платежей<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="26"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="84"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="127" HEIGHT="84"> 
        <DIV WIDTH="127" HEIGHT="84"> 
          <P> <font face="Times New Roman, Times, serif" size="3">бз<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="489" HEIGHT="84"> 
        <DIV WIDTH="489" HEIGHT="84"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Будущая стоимость 
            или баланс наличности, который нужно достичь после последней выплаты. 
            Если бз опущено, оно полагается равным 0 (будущая стоимость займа, 
            например, равна 0)<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="84"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="65"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="127" HEIGHT="65"> 
        <DIV WIDTH="127" HEIGHT="65"> 
          <P> <font face="Times New Roman, Times, serif" size="3">тип<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="489" HEIGHT="65"> 
        <DIV WIDTH="489" HEIGHT="65"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Число 0 или 
            1, обозначающее, когда должна производиться выплата. Если тип равен 
            0 или опущен, то оплата в конце периода, если — 1, то в начале периода<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="65"> </TD>
    </TR>
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="127" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="489" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
  </TABLE>
</div>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">При решении 
  задачи о сделке Ксенофона Заковыркина пользователь вводит значения следующих 
  параметров: число выплат (кпер), размер ссуды, размер одной выплаты (выплата) 
  и процентную ставку (ставка).<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Приложение 
  вычисляет с помощью функции пз (PV) при данной годовой ставке текущий объем 
  вклада. Маргинальная процентная ставка находится как корень уравнения:<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Текущий объем 
  вклада = размер ссуды<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Данное соотношение 
  является уравнением относительно одной неизвестной величины -- процентной ставки. 
  Корень одного уравнения с одной неизвестной находится на рабочем листе с помощью 
  команды <B>Сервис, Подбор параметра </B>(Tools, GoalSeek) или программно посредством 
  метода GoalSeek.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><B><font size="4"><a name="4"></a>Практика</font></B><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Для решения 
  задачи нахождения текущего объема вклада и нахождения маргинальной процентной 
  ставки с помощью редактора пользовательских форм создадим Диалоговое окно Маргинальная 
  процентная ставка (рис. У2.1).<BR>
  </font></P>
<P align="left"><img src="2.1.gif" width="452" height="232"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У2.1. Диалоговое окно </I></B><I>Маргинальная процентная ставка</I><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Обсудим, 
  как приведенная ниже программа решает перечисленные выше задачи и что происходит 
  в программе.<BR>
  </font></P>
<div align="left"> 
  <TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="550" HEIGHT="290">
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="206" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="410" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="168"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="206" HEIGHT="168"> 
        <DIV WIDTH="206" HEIGHT="168"> 
          <P> <font face="Times New Roman, Times, serif" size="3">UserForm Initialize<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="410" HEIGHT="168"> 
        <ol>
          <li> 
            <DIV WIDTH="410" HEIGHT="168"> <font face="Times New Roman, Times, serif" size="3"> 
              Активизирует диалоговое окно. </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="410" HEIGHT="168"><font face="Times New Roman, Times, serif" size="3">Запрещает 
              ввод данных пользователем в поля Текущий объем ссуды И Маргинальная 
              процентная ставка.<BR>
              </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="410" HEIGHT="168"><font face="Times New Roman, Times, serif" size="3">Назначает 
              клавише &lt;Esc&gt; функцию кнопки отмена, а клавише &lt;Enter&gt; 
              - вычислить. </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="410" HEIGHT="168"><font face="Times New Roman, Times, serif" size="3">Связывает 
              с кнопками Вычислить и отмена всплывающие подсказки.<BR>
              </font></DIV>
          </li>
        </ol>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="168"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="122"></TD>
      <td width="206" height="122"> 
        <div width="206" height="122"> 
          <p> <font face="Times New Roman, Times, serif" size="3">Нажатие кнопки 
            вычислить запускает на выполнение процедуру<br>
            </font></p>
          <p> <font face="Times New Roman, Times, serif" size="3">CommandButton1_Click<br>
            </font></p>
        </div>
      </td>
      <td width="410" height="122"> 
        <ol start=5>
          <li> 
            <div width="410" height="122"> <font face="Times New Roman, Times, serif" size="3">Проверяет, 
              являются ли вводимые данные числами. Если хотя бы одно из них не 
              является числом, то на экране отображается соответствующее информационное 
              сообщение с ; установкой фокуса на поле, где произведен некорректный 
              ввод данных.</font></div>
          </li>
          <li> 
            <div width="410" height="122"><font face="Times New Roman, Times, serif" size="3"> 
              Проверяет, будет ли ссуда меньше, чем возвращаемая сумма денег. 
              Если ссуда больше этой суммы, то отображается сообщение с указанием, 
              на сколько ссуда меньше возвращаемой суммы денег (рис. У2.2). </font></div>
          </li>
          <li> 
            <div width="410" height="122"><font face="Times New Roman, Times, serif" size="3">Используя 
              финансовую функцию рабочего листа, пз (PV) вычисляет чистый текущий 
              объем ссуды при введенной процентной ставке.<br>
              </font></div>
          </li>
          <li> 
            <div width="410" height="122"> <font face="Times New Roman, Times, serif" size="3"> 
              Используя метод Goaiseek (подбор параметра), находит маргинальную 
              процентную ставку, т. е. ставку, при которой чистый текущий объем 
              ссуды равен величине самой ссуды.</font></div>
          </li>
          <li> 
            <div width="410" height="122"><font face="Times New Roman, Times, serif" size="3"> 
              Подготавливает рабочий лист для вывода результатов вычислений. Выводит 
              полученные данные на рабочий лист и в диалоговое окно (рис. У2.3).</font></div>
          </li>
        </ol>
        <div width="410" height="122"> 
          <p><font face="Times New Roman, Times, serif" size="3"><br>
            </font></p>
        </div>
      </td>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="122"></TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="122"> </TD>
      <td width="206" height="78"> 
        <div width="206" height="78"> 
          <p> <font face="Times New Roman, Times, serif" size="3">Нажатие кнопку 
            отмена запускает на выполнение процедуру<br>
            </font></p>
          <p> <font face="Times New Roman, Times, serif" size="3">CommandButton2_Click<br>
            </font></p>
        </div>
      </td>
      <td width="410" height="78"> 
        <div width="410" height="78"> 
          <p> <font face="Times New Roman, Times, serif" size="3">Закрывает диалоговое 
            окно.<br>
            </font></p>
        </div>
      </td>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="122"> </TD>
    </TR>
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="206" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="410" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
  </TABLE>
  
  <p><img src="2.2.gif" width="304" height="121"></p>
  <p><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. У2.2. </I></B><I>Сообщение</I> 
    <I>о некорректном вводе данных</I><BR>
    </font></p>
</div>
<P align="left"><img src="2.3.gif" width="436" height="351"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У2.3. </I></B><I>Отчет, выводимый на рабочем листе программой расчета маргинальной 
  процентной ставки</I><BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButtonl_Click() '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  расчета маргинальной процентной ставки </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim i As Double 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Dim p As Double 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Dim A <I>As </I>Double 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Dim iMarg As 
  Double </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Dim pPure As 
  Double </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Dim n As Integer<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' n - число 
  выплат<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' p - размер 
  ссуды<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' a - размер 
  одной выплаты<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' i - процентная 
  ставка<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' pPure - текущий 
  объем ссуды,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'на рабочем 
  листе вычисляется функцией ПЗ<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' iMarg - маргинальная 
  процентная ставка<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Проверка того, 
  чтобы введенные<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' в диалоговое 
  окно данные являются числами </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If<I> </I>IsNumeric(TextBoxl.Text) 
  = False Then MsgBox &quot;Ошибка в числе выплат&quot;,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">vblnformation, 
  &quot;Маргинальная ставка&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">TextBoxl.SetFocus 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Exit Sub</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End If<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If IsNumeric(TextBox2.Text) 
  = False Then MsgBox &quot;Ошибка в размере ссуды&quot;,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">vblnformation, 
  &quot;Маргинальная ставка&quot; TextBox2.SetFocus </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Exit Sub </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End If<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If IsNumeric(UserForml.TextBox3.Text) 
  = False Then MsgBox &quot;Ошибка в размере одной выплаты&quot;,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">vblnformation, 
  &quot;Маргинальная ставка&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">TextBox3.SetFocus</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> Exit Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End If </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If IsNumeric(TextBox4.Text) 
  = False Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Ошибка 
  в процентной ставке&quot;,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">vblnformation, 
  &quot;Маргинальная ставка&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">TextBox2.SetFocus<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Exit Sub</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End If<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Ввод данных 
  в переменные из диалогового окна </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">n = CInt(TextBoxl.Text)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> р = CDbl(TextBox2.Text)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> А = CInt(TextBqx3.Text) 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">i = CInt(TextBox4.Text) 
  / 100<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Проверка согласованности 
  ввода данных </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If n * А &lt; 
  р Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Возвращается 
  на &quot; &amp; CStr(Format(р - n * A, &quot;Fixed&quot;)) &amp; &quot; меньше 
  размера ссуды&quot;, vbExclamation, &quot;Маргинальная ставка&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> TextBoxl.SetFocus</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> Exit Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End If </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Изменение 
  ширины столбцов и задание режима ввода<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' текста с переносом 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveSheet.Columns(&quot;A:A&quot;).Select 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">With Selection<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.ColumnWidth 
  =20 .WrapText = True</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveSheet.Columns(&quot;B:B&quot;).Select 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Selection.ColumnWidth 
  = 12<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Выбор ячейки 
  В2 для того, чтобы снять выделение со столбца В<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveSheet.Range(&quot;В2&quot;).Select 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Ввод названий 
  записей на рабочем листе<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With ActiveSheet<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;A2&quot;).Value 
  = &quot;Число выплат&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;A3&quot;).Value 
  = &quot;Размер ссуды&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;A4&quot;).Value 
  = &quot;Размер одной выплаты&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;A5&quot;).Value 
  = &quot;Процентная ставка&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;A6&quot;).Value 
  = &quot;Текущий объем ссуды&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;А7&quot;).Value 
  = &quot;Маргинальная процентная ставка&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;A8&quot;).Value 
  = &quot;Маргинальный чистый текущий объем ссуды&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;B8&quot;).Activate 
  End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Расчет чистого 
  текущего объема ссуды </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">pPure = Application.PV(i, 
  n, -A) </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Нахождение 
  маргинальной процентной ставки<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' с помощью 
  команды Подбор параметра.<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Ввод данных 
  в ячейки активного рабочего листа<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' и задание 
  процентного и денежного форматов в ячейках<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With ActiveSheet<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;B2&quot;).Value 
  = n<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;B3&quot;).NumberFormat 
  = &quot;#,##0$&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;B3&quot;).Value 
  = p<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;B4&quot;).NumberFormat 
  = &quot;#,##0$&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;B4&quot;).Value 
  = A<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;B5&quot;).NumberFormat 
  = &quot;0.00%&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;B5&quot;).Value 
  = i<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;B7&quot;).NumberFormat 
  = &quot;0.00%&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Ввод начального 
  приближения для маргинальной процентной ставки<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;B7&quot;).Value 
  = i<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Ввод формулы 
  расчета '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;B8&quot;).FormulaLocal 
  = &quot;=ПЗ(B7;B2;-B4)&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;B6&quot;).Value 
  = .Range(&quot;B8&quot;).Value </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Выполнение 
  команды Подбор параметра </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;B8&quot;).GoalSeek 
  Goal:=p, ChangingCell:=.Range(&quot;B7&quot;)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Присвоение 
  найденного значения маргинальной процентной ставки </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">' переменной 
  iMarg<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">iMarg = .Range(&quot;B7&quot;).Value<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Переформатирование 
  найденных значений ' и вывод их в диалоговом окне<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">TextBoxS.Text 
  = CStr(Format(pPure, &quot;Fixed&quot;))</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> TextBox6.Text 
  = CStr(Format(iMarg * 100, &quot;Fixed&quot;))<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButton2_Click()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  закрытия диалогового окна<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">UserForml.Hide</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  UserForm_Initialize()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  вызова диалогового окна.<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Поля<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Чистый текущий 
  объем ссуды<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' и Маргинальная 
  процентная ставка </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">' доступны для 
  вывода информации, но не для ее ввода<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">TextBox5.Enabled 
  = False<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">TextBox6.Enabled 
  = False<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Клавише &lt;Enter&gt; 
  назначена функция кнопки Вычислить<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Кнопке Вычислить 
  назначен текст всплывающей подсказки </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With CommandButtonl 
  .Default = True </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.ControlTipText 
  = &quot;Расчет и составление отчета на рабочем листе&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Клавише &lt;Esc&gt; 
  назначена функция кнопки Отмена<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Кнопке Отмена 
  назначен текст всплывающей подсказки<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With CommandButton2 
  .Cancel = True</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> .ControlTipText 
  = &quot;Кнопка отмены&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">UserForml.Show 
  End Sub</font><font face="Times New Roman, Times, serif" size="3"><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">При написании 
  программ, в которых используется те или иные возможности рабочего листа, а не 
  только VBA, часто бывает удобным вариантом воспользоваться средством MacroRecorder. 
  Он создаст макрос, описывающий на языке VBA осуществляемые вами действия. MacroRecorder 
  является одним из интеллектуальных средств Microsoft Office, которое облегчает 
  работу разработчиков приложений. Конечно, создаваемый им макрос будет во многих 
  отношениях не оптимальным, но тем не менее он даст хорошую подсказку о том, 
  какие инструкции должны быть добавлены в программу, чтобы добиться требуемого 
  эффекта.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Итак, для 
  активизации MacroRecorder выберите команду <B>Сервис, Макрос. Начать запись 
  </B>(Tools, Macro, Record New Macro) и запустите MacroRecorder на запись. После 
  задания всех параметров в появившемся диалоговом окне <B>Запись макроса </B>(Record 
  Macro) и нажатия кнопки <B>ОК, </B>появится плавающая </font><font face="Times New Roman, Times, serif" size="3">панель 
  инструментов с кнопкой <B>Остановить запись </B>(Stop Recording). Теперь все 
  производимые действия будут записываться до тех пор, пока не будет нажата эта 
  кнопка.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Сперва решите 
  уравнение, вычисляющее маргинальную процентную ставку. В ячейку В2 введено число 
  выплат, равное б, ячейка B7 отведена под процентную ставку, а в ячейку вб введена 
  формула =пз{В7;в2;-B4), вычисляющая текущий объем ссуды. Требуется найти процентную 
  ставку, при которой текущий объем ссуды равен 10 000.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Итак, MacroRecorder 
  включен, осталось решить данную задачу вручную на рабочем листе и посмотреть 
  на записанный макрос.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Решите задачу 
  в соответствии со следующим алгоритмом:<BR>
  </font></P>
<ol>
  <li> <font face="Times New Roman, Times, serif" size="3"> Выберите команду <B>Сервис, 
    Подбор параметра </B>(Tools, Goal Seek).<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> В появившемся диалоговом 
    окне <B>Подбор параметра </B>(Goal Seek) в поле <B>Установить в ячейке </B>(Set 
    cell) укажите ссылку на ячейку B6, где содержится формула с левой частью решаемого 
    уравнения. В поле <B>Значение </B>(То value) введите число 10 000, значение 
    правой части решаемого уравнения. В поле <B>Изменяя значение ячейки </B>(By 
    changing cell) укажите ссылку на ячейку B7, которая отведена под неизвестную 
    в решаемом уравнении.<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Нажмите на кнопку 
    <B>ОК. </B>Появится диалоговое окно <B>Результат подбора параметра </B>(Goal 
    Seek Status) с информацией о найденном решении.<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Нажмите на кнопку 
    ОК диалогового окна <B>Результат подбора параметра</B> </font><font face="Times New Roman, Times, serif" size="3">(Goal 
    Seek Status).<BR>
    </font></li>
</ol>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Перечисленные 
  выше действия будут переведены MacroRecorder в следующий макрос.<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Sub Макрос1()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Макрос1 Макрос<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Макрос записан 
  06.05.99 (Ксенофон Заковыркин)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Range (&quot;B8&quot;) 
  .GoalSeek Goal:=10000, </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">ChangingCell:=Range 
  (&quot;-B7&quot;) </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End Sub<BR>
  </font><font face="Times New Roman, Times, serif" size="3"> </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Как видно 
  из записанного макроса, несмотря на многошаговость процесса решения уравнения 
  вручную, программно это решение состоит только из одной инструкции. Во избежание 
  ошибок при написании программ, те фрагменты, которые можно создать с помощью 
  MacroRecorder, лучше и создавать с его помощью. Потом лишь скопировать их в 
  исходную програм</font><font face="Times New Roman, Times, serif" size="3">му, 
  внеся требуемые изменения, если в этом возникнет необходимость. Как говорится, 
  &quot;Береженого Бог бережет&quot;. MacroRecorder, в отличие от неопытного пользователя, 
  не делает синтаксических ошибок. Без сомнения, MacroRecorder также может быть 
  незаменим и для маститого профессионала. Не только потому, что &quot;и на старуху 
  бывает проруха&quot;, а главное по причине того, что он действительно помогает 
  существенно ускорить процесс создания приложения.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">При написании 
  программы данного приложения MacroRecorder может также пригодиться для задания 
  числовых форматов в ячейках вз, В4, B5 и B7.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Итак, для 
  активизации MacroRecorder выберите команду <B>Сервис, Макрос, Начать запись 
  </B>(Tools, Macro, Record New Macro) и запустите MacroRecorder на запись.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Задавайте 
  числовые форматы в ячейках вз, В4, В5 и BV по следующему алгоритму:<BR>
  </font></P>
<ol>
  <li> <font face="Times New Roman, Times, serif" size="3">Выделите ячейку вз. 
    Выберите команду <B>Формат, Ячейки </B>(Format, Cells). В появившемся диалоговом 
    окне <B>Формат ячеек </B>(Format Cells), на вкладке <B>Число </B>(Number) 
    в списке <B>Числовые форматы </B>(Category) выберите Денежный (Currency). 
    В поле <B>Число десятичных знаков </B>(Decimal places) введите 0, а в раскрывающемся 
    списке <B>Обозначения </B>(Symbol) выберите р. Нажмите кнопку <B>ОК.</B><BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Выделите ячейку В4 
    и установите в ней числовой формат, как описано в выше.<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Выделите ячейку В5. 
    Выберите команду <B>Формат, Ячейки </B>(Format, Cells). В появившемся диалоговом 
    окне <B>Формат ячеек </B>(Format Cells) на вкладке <B>Число </B>(Number) в 
    списке <B>Числовые форматы </B>(Category) выберите <B>Процентный </B>(Percentage). 
    В поле <B>Число десятичных знаков </B>(Decimal places) введите 2. Нажмите 
    кнопку <B>ОК.</B><BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Выделите ячейку B7 
    и установите в ней числовой формат, как описано в предыдущем пункте.<BR>
    </font></li>
</ol>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Перечисленные 
  выше действия будут переведены MacroRecorder в следующий макрос.<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Sub Макрос3()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' МакросЗ Макрос<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Макрос записан 
  06.05.99 (Ксенофон Заковыркин)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Range(&quot;ВЗ&quot;).Select<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Selection.NumberFormat 
  = &quot;#,##0$&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Range(&quot;B4&quot;).Select 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Selection.NumberFormat 
  = &quot;#,##0$&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Range(&quot;B5&quot;).Select</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> Selection.NumberFormat 
  = &quot;0.00%&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Range(&quot;B7&quot;).Select 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Selection.NumberFormat 
  = &quot;0.00%&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End Sub<BR>
  </font><font face="Times New Roman, Times, serif" size="3"> </font></P>
<P align="left"><img src="2.4.gif" width="399" height="378"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У2.4. </I></B><I>Диалоговое окно <B>Формат ячеек</B></I><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Созданные 
  в данном макросе инструкции как раз и осуществляют требуемое в программе приложения 
  форматирование.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><B><font size="4"><a name="5"></a>Самостоятельное 
  задание</font></B><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Разработать 
  приложение с диалоговым окном Решение уравнения (рис. У2.5) для реализации следующих 
  задач:<BR>
  </font></P>
<ul>
  <li> <font face="Times New Roman, Times, serif" size="3"> Нахождение корней 
    уравнения <I>хе<SUP>bx</SUP> = а</I><BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Отметим, что данное 
    уравнение в зависимости от параметров <I>а </I>и <I>b </I>может иметь два 
    корня, либо только один корень, либо вообще их не иметь. В приложении следует 
    предусмотреть отображение информационного со</font><font face="Times New Roman, Times, serif" size="3">общения 
    о том, сколько корней при вводимом наборе параметров имеет уравнение. В случае 
    наличия корней вывести их значения<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Используя свойство 
    visible (видимый) элементов управления, сделайте так, чтобы в группе корни 
    в случае единственного корня отображалось только одно поле с этим корнем, 
    а при отсутствии корней в этой группе не отображалось бы ни одного поля, но 
    вместо них отображался бы элемент управления Caption (надпись) с текстовым 
    сообщением об их отсутствии.<BR>
    </font></li>
</ul>
<P align="left"><img src="2.5.gif" width="295" height="239"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У2.5. </I></B><I>Диалоговое окно Решение уравнения</I></font></P>
</BODY>
</HTML>

