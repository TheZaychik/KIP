<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML>
<HEAD>
<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=WINDOWS-1251">
<META NAME="GENERATOR" CONTENT="ABBYY FineReader 6.0">

</HEAD>

<body background=../FON.JPG>
      <ul>
<li><b><font face="Times New Roman" size=3><a href="#1">УРОК 9. ТЕМА: ПЕРИОДИЧЕСКИЕ ВЫПЛАТЫ.


ПОСТРОЕНИЕ ДИАГРАММ
</a></font></b> </li>
     <ul>
     <li><font face="Times New Roman" size=3><a href="#2">ЦЕЛЬ УРОКА</a></font> </li>
     <li><font face="Times New Roman" size=3><a href="#3">ТЕОРИЯ</a></font> </li>
     <li><font face="Times New Roman" size=3><a href="#4">ПРАКТИКА</a></font> </li>
     <li><font face="Times New Roman" size=3><a href="#5">САМОСТОЯТЕЛЬНОЕ ЗАДАНИЕ</a></font> </li>

     </ul></ul>


<A NAME="1"></A>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><B>Урок 9</B>.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><font size="5">Тема:</font> 
  <font size="5">Периодические выплаты. Построение диаграмм</font><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><B><font size="4"><a name="2"></a>Цель 
  урока</font></B><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">В разрабатываемом 
  в данном уроке приложении решается задача нахождения размера постоянных платежей 
  по выданной в долг сумме на фиксированный срок под фиксированные проценты. Приложение 
  рассчитывает размер выплат для различных процентных ставок, изменяющихся от 
  начальной до конечной величины с указанным шагом. Кроме того, приложение строит 
  диаграмму, показывающую зависимость величины выплат от процентной ставки.<BR>
  </font></P>
<ul>
  <li> <font face="Times New Roman, Times, serif" size="3">Конструируя данное 
    приложение, вы на практике освоите, как:<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Производить расчет 
    периодических выплат<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Использовать финансовую 
    функцию ППЛАТ ( РМТ )<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Выводить результаты 
    табулирования функции в элемент управления ListBox (СПИСОК)<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Строить диаграмму, 
    тип которой выбирается в группе переключателей </font></li>
  <li><font face="Times New Roman, Times, serif" size="3"> Отображать графический 
    файл в элементе управления image (рисунок) </font></li>
  <li><font face="Times New Roman, Times, serif" size="3"> Осуществлять проверку 
    наличия файла на диске<BR>
    </font></li>
</ul>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><B><font size="4"><a name="3"></a>Теория</font></B><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Функция ППЛАТ 
  (РМТ) вычисляет величину постоянной периодической выплаты ренты (например, регулярных 
  платежей по займу) при постоянной процентной ставке.<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Синтаксис:<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">ППЛАТ(ставка; 
  кпер; нз; бз; тип)<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Аргументы:<BR>
  </font></P>
<div align="left"> 
  <TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="550" HEIGHT="261">
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="84" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="534" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="29"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="84" HEIGHT="29"> 
        <DIV WIDTH="84" HEIGHT="29"> 
          <P> <font face="Times New Roman, Times, serif" size="3">ставка<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="534" HEIGHT="29"> 
        <DIV WIDTH="534" HEIGHT="29"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Процентная ставка 
            за период<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="29"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="28"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="84" HEIGHT="28"> 
        <DIV WIDTH="84" HEIGHT="28"> 
          <P> <font face="Times New Roman, Times, serif" size="3">кпер<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="534" HEIGHT="28"> 
        <DIV WIDTH="534" HEIGHT="28"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Общее число 
            периодов выплат<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="28"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="46"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="84" HEIGHT="46"> 
        <DIV WIDTH="84" HEIGHT="46"> 
          <P> <font face="Times New Roman, Times, serif" size="3">нз<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="534" HEIGHT="46"> 
        <DIV WIDTH="534" HEIGHT="46"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Текущее значение, 
            т. е. общая сумма, которую составят будущие платежи<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="46"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="88"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="84" HEIGHT="88"> 
        <DIV WIDTH="84" HEIGHT="88"> 
          <P> <font face="Times New Roman, Times, serif" size="3">бз<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="534" HEIGHT="88"> 
        <DIV WIDTH="534" HEIGHT="88"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Будущая стоимость 
            или баланс наличности, который нужно достичь после последней выплаты. 
            Если аргумент бз опущен, то по умолчанию полагается равным 0 (будущая 
            стоимость займа, например, равна 0)<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="88"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="70"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="84" HEIGHT="70"> 
        <DIV WIDTH="84" HEIGHT="70"> 
          <P> <font face="Times New Roman, Times, serif" size="3">тип<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="534" HEIGHT="70"> 
        <DIV WIDTH="534" HEIGHT="70"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Допустимые значения: 
            0 или 1, обозначающие, когда должна производиться выплата. Если аргумент- 
            тип равен 0 или опущен, то оплата в конце периода, если равен 1 , 
            то в начале периода<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="70"> </TD>
    </TR>
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="84" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="534" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
  </TABLE>
</div>
<P align="left">&nbsp; </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><font size="4"><a name="4"></a>Практика</font></B><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">В данном 
  приложении решается задача нахождения размера постоянных платежей по выданной 
  в долг сумме на фиксированный срок под фиксированные проценты. Приложение рассчитывает 
  размер выплат для различных процентных ставок, изменяющихся от начальной до 
  конечной с указанным шагом.<BR>
  </font></P>
<P align="left"><img src="9.1.gif" width="519" height="272"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У9.1. </I></B><I>Диалоговое окно Периодических выплат</I><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Кроме того, 
  приложение строит диаграмму, показывающую зависимость величины выплат от процентной 
  ставки. Тип диаграммы можно задать, вы</font><font face="Times New Roman, Times, serif" size="3">бирая 
  переключатель из группы диаграмма диалогового окна Периодических выплат (рис. 
  У9.1). Результат табуляции зависимости размера выплат от процентной ставки выводится 
  в элемент управления ListBox диалогового окна и на рабочий лист (рис. У9.2).<BR>
  </font></P>
<P align="left"><img src="9.2.gif" width="514" height="556"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У9.2. </I></B><I>Отчет, создаваемый приложением на рабочем листе</I><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Обсудим, 
  как приведенная ниже программа решает описанную задачу и что в ней происходит.<BR>
  </font></P>
<div align="left"> 
  <TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="550" HEIGHT="404">
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="189" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="427" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="282"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="189" HEIGHT="282"> 
        <DIV WIDTH="189" HEIGHT="282"> 
          <P> <font face="Times New Roman, Times, serif" size="3">UserForm Initialize<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="427" HEIGHT="282"> 
        <ol>
          <li> 
            <DIV WIDTH="427" HEIGHT="282"> <font face="Times New Roman, Times, serif" size="3"> 
              Активизирует диалоговое окно. </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="427" HEIGHT="282"><font face="Times New Roman, Times, serif" size="3"> 
              Назначает клавише &lt;Esc&gt; функцию кнопки Отмена, а клавише &lt;Enter&gt; 
              — вычислить, а также задает тексты всплывающих подсказок для этих 
              кнопок и кнопки Очистка.</font></DIV>
          </li>
          <li>
            <DIV WIDTH="427" HEIGHT="282"><font face="Times New Roman, Times, serif" size="3">Устанавливает 
              изначально переключатель гистограмма. Проверяет наличие на диске 
              файла, отображаемого в элементе управления image при данном выборе 
              переключателя. Если такого файла нет, то информирует об этом пользователя, 
              но тем не менее программа продолжает свою работу без загрузки отсутствующего 
              файла. Если файл есть, изображение, содержащееся в этом файле, выводится 
              в элементе управления image.<BR>
              </font></DIV>
          </li>
        </ol>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="282"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="122"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="189" HEIGHT="122"> 
        <DIV WIDTH="189" HEIGHT="122"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Нажатие кнопки 
            Вычислить запускает на выполнение процедуру<BR>
            </font></P>
          <P> <font face="Times New Roman, Times, serif" size="3">CommandButtonl_Click<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="427" HEIGHT="122"> 
        <ol>
          <li> 
            <DIV WIDTH="427" HEIGHT="122"> <font face="Times New Roman, Times, serif" size="3"> 
              Проверяет, являются ли вводимые данные числами. В случае ошибки 
              отображает соответствующее сообщение. </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="427" HEIGHT="122"><font face="Times New Roman, Times, serif" size="3"> 
              Проверяет согласованность вводимых данных. В случае ошибки отображает 
              соответствующее сообщение (рис. У9.3).</font></DIV>
          </li>
          <li> 
            <DIV WIDTH="427" HEIGHT="122"><font face="Times New Roman, Times, serif" size="3"> 
              Вводит на рабочий лист заголовки записей и их форматирует.<br>
              </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="427" HEIGHT="122"> <font face="Times New Roman, Times, serif" size="3">Определяет 
              число точек, в которых будут табулироваться процентные ставки. </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="427" HEIGHT="122"><font face="Times New Roman, Times, serif" size="3">Последовательно 
              находит размеры выплат для очередной процентной ставки, меняющейся 
              от начального значения до конечного с указанным шагом. Результаты 
              вычислений выводит на рабочем листе и в двумерный массив ЭлементыСписка, 
              число строк которого равно числу процентных ставок. В первый его 
              столбец выводятся процентные ставки, а во второй -величины соответствующих 
              выплат. </font></DIV>
          </li>
          <li> 
            <DIV WIDTH="427" HEIGHT="122"><font face="Times New Roman, Times, serif" size="3"> 
              На основе массива ЭлементыСписка заполняется список, предварительно 
              очищенный от ранее введенных в него элементов.</font></DIV>
          </li>
          <li>
            <DIV WIDTH="427" HEIGHT="122"><font face="Times New Roman, Times, serif" size="3"> 
              В соответствии с установленным переключателем из группы диаграмма 
              при помощи процедуры график строится выбранная диаграмма.</font></DIV>
          </li>
        </ol>
        <DIV WIDTH="427" HEIGHT="122">
          <P><font face="Times New Roman, Times, serif" size="3"><BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="122"> </TD>
    </TR>
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="189" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="427" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
  </TABLE>
  
</div>
<P align="left">&nbsp; </P>
<P align="left"><img src="9.3.gif" width="294" height="113"></P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У9.3. </I></B><I>Пример сообщения о несогласованности данных</I><BR>
  </font></P>
<div align="left"> 
  <TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="550" HEIGHT="287">
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="220" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="398" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="201"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="220" HEIGHT="201"> 
        <DIV WIDTH="220" HEIGHT="201"> 
          <P> <font face="Times New Roman, Times, serif" size="3">OptionButton1_Click, 
            OptionButton2_Click<BR>
            </font></P>
          <P> <font face="Times New Roman, Times, serif" size="3">и<BR>
            </font></P>
          <P> <font face="Times New Roman, Times, serif" size="3">OptionButton3_Click<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="398" HEIGHT="201"> 
        <DIV WIDTH="398" HEIGHT="201"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Выбирает переключатель 
            гистограмма, график или Круговая группы Диаграмма. Проверяет наличие 
            на диске файла, отображаемого в элементе управления image при данном 
            выборе переключателя. Если такого файла нет, то информирует об этом 
            пользователя, и программа продолжает свою работу без загрузки отсутствующего 
            файла. Если файл имеется, то изображение, содержащееся в этом файле, 
            выводится в элементе управления Image .<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="201"> </TD>
    </TR>
    <TR ALIGN="LEFT" VALIGN="TOP"> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="86"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="220" HEIGHT="86"> 
        <DIV WIDTH="220" HEIGHT="86"> 
          <P> <font face="Times New Roman, Times, serif" size="3">График<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="398" HEIGHT="86"> 
        <DIV WIDTH="398" HEIGHT="86"> 
          <P> <font face="Times New Roman, Times, serif" size="3">Удаляет с рабочего 
            листа все ранее построенные диаграммы. Строит диаграмму на рабочем 
            листе. Аргументами процедуры являются ТипГрафика и его Формат.<BR>
            </font></P>
        </DIV>
      </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="86"> </TD>
    </TR>
    <TR> 
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="220" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="398" HEIGHT="0"> </TD>
      <TD ALIGN="LEFT" VALIGN="TOP" WIDTH="0" HEIGHT="0"> </TD>
    </TR>
  </TABLE>
</div>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButtonl_Click()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  вычисления выплат по ссуде<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim p As Double<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim i_нпc As 
  Double<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim i кпс As 
  Double<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim i_шar As 
  Double<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim k As Integer<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim i As Integer<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim n As Integer<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim m As Integer<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim A()As Double<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim Проценты() 
  As Double<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim ПроцентыФормат() 
  As Variant<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim ЭлементыСписка() 
  As Variant<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim Area As 
  Object </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' i_нпс - начальная 
  процентная ставка<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' i_кnc - конечная 
  процентная ставка<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' i_inar - шаг 
  процентной ставки<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' р - ссуда<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' k - число 
  выплат<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'А() - динамический 
  массив значений выплат<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Проценты() 
  - динамический массив значений процентных ставок<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' ПроцентыФормат() 
  - динамический массив значений процентных ставок,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' отформатированных 
  по процентному формату<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' ЭлементыСписка() 
  - динамический массив, состоящий из двух столбцов:<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' значений процентных 
  ставок и выплат, выводимых в список</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Проверка: 
  вводятся ли в поля диалогового окна числа </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If IsNumeric(TextBoxl.Text) 
  = False Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Ошибка 
  в ссуде&quot;, vbInformation, &quot;Выплаты&quot; TextBox1.SetFocus </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Exit Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End If<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If IsNumeric(TextBox2.Text) 
  = False Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Ошибка 
  в числе выплат&quot;, vblnformation, &quot;Выплаты&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">TextBox2.SetFocus<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Exit Sub</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End If </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">If IsNumeric(TextBox3.Text) 
  = False Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Ошибка 
  в начальной процентной ставке&quot;, vblnformation, &quot;Выплаты&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">TextBox3.SetFocus<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Exit Sub</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End If </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">If IsNumeric(TextBox4.Text) 
  = False Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Ошибка 
  в конечной процентной ставке&quot;, vblnformation, &quot;Выплаты&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">TextBox4.SetFocus<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Exit Sub </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End If </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">If IsNumeric(TextBoxS.Text) 
  = False Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Ошибка 
  в шаге процентной ставки&quot;, vblnformation, &quot;Выплаты&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">TextBox5.SetFocus<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Exit Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End If </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Присвоение 
  переменным значений, вводимых в диалоговом окне </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">р = CDbl(TextBoxl.Text)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">k = CInt(TextBox2.Text)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">i_нпс = CDbl(TextBox3.Text) 
  / 100<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">i_Knc = CDbl(TextBox4.Text) 
  / 100<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">i_шar = CDbl(TextBox5.Text) 
  / 100 </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Проверка согласованности 
  вводимых процентных ставок. </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">' Несогласованность 
  ввода отображается в сообщении </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If i_кпс &lt; 
  i_нпс Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Конечная 
  процентная ставка меньше начальной&quot;,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">vbExclamation, 
  &quot;График&quot; TextBox3.SetFocus<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Exit Sub End 
  If If i_кпс &lt; i_нпс + i_шar Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Шаг 
  слишком большой!&quot; &amp; Chr(13) &amp;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">&quot;Табулируется 
  только одно значение.&quot;, vbExclamation, &quot;График&quot; TextBox5.SetFocus 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Exit Sub</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End If</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">If i_шar &lt;= 
  0 Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Шаг 
  должен быть положительным!&quot;,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">vbExclamation, 
  &quot;График&quot; TextBox5.SetFocus </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Exit Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End If</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Очистка рабочего 
  листа от результатов предыдущих вычислений '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveSheet.Cells.Clear<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' m - количество 
  процентных ставок </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">m = (i_кпс - 
  i_нпс) / i_шаг + 1<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Установка 
  границ динамических массивов Проценты, </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">' ПроцентыФормат 
  и А<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ReDim А(1 Тo 
  m)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ReDim Проценты(1 
  То m)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ReDim ПроцентыФормат(1 
  То m) </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Ввод заголовков 
  записей на рабочий лист<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With ActiveSheet<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;A:A&quot;).ColumnWidth 
  =17.6</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> .Range(&quot;Al&quot;).Value 
  = &quot;Процентная ставка&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Range(&quot;A2&quot;).Value 
  = &quot;Размер выплаты&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Range(&quot;A3&quot;).Value 
  = &quot;Ссуда&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;A4&quot;).Value 
  = &quot;Число выплат&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Форматирование 
  заголовков записей </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveSheet. 
  Range (&quot;Al: A4 &quot;) </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Select With 
  Selection<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.HorizontalAlignment 
  = xlGeneral<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.VerticalAlignment 
  = x1Bottom<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.WrapText = 
  False<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Orientation 
  = 30<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.ShrinkToFit 
  = False<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.MergeCells 
  = False</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End With</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> With Selection.Interior<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.CqlorIndex 
  =36<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Pattern = xlSolid<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.PatternColorlndex 
  = xlAutomatic<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Вывод данных 
  на- рабочем листе </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With ActiveSheet 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">For i = 1 To 
  m<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Проценты(i) 
  = i_нпс + i_шar * (i - 1) A(i) = Application.Pmt(Проценты(i), k, -p) A(i) = 
  Format(A(i), &quot;##&quot;)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ПроцентыФормат(i) 
  = Format (ПроцентыЦ) , &quot;#.0%&quot;)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> .Cells(1, i 
  + 1}.Value = ПроцентыФормат(i)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> .Cells(2, i 
  + 1).Value = A(i) </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Next i<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Range(&quot;B3&quot;).Value 
  = p </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Range(&quot;B4&quot;).Value 
  = k<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Установка 
  границ динамического массива ЭлементыСписка</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> ' Используется 
  для вывода значений процентных ставок<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' и значений 
  соответствующих выплат в список </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ReDim ЭлементыСписка(i 
  To m, 0 To 1)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Поэлементное 
  определение массива ЭлементыСписка<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">For i = 1 То 
  m<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ЭлементыСписка(i, 
  0) = ПроцентыФормат(i)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ЭлементыСписка(i, 
  1) = A(i)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> Next i<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Заполнение 
  списка с двумя колонками данных </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With ListBoxl 
  .Clear<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.ColumnCount 
  = 2 </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.List = ЭлементыСписка() 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.Listlndex = 
  0<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End With '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Удаление всех 
  графических объектов с активного рабочего листа</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveSheet.ChartObjects.Delete 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Определение 
  выбранного переключателя,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' задающего 
  тип диаграммы и <BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' построение 
  выбранной диаграммы </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If OptionButtonl.Value 
  = True Then График xlColumn, 6 </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">If OptionButton2.Value 
  = True Then График xlLine, 10 </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">If OptionButton3.Value 
  = True Then График xlPie, 7<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Sub График(ТипГрафика 
  As Integer, Формат As Integer) </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  построения графика<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' ТипГрафика 
  - определяет тип диаграммы на втором шаге мастера диаграмм<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Формат - определяет 
  вид диаграммы на третьем шаге мастера диаграмм<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim Area As 
  Object<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Dim n As Integer</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Объектная 
  переменная Area - диапазон, по которому строится диаграмма<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Set Area = ActiveSheet.Cells(1, 
  2).CurrentRegion<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' n - число 
  столбцов диапазона Area </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">n = Area.Columns.Count<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' (195, 30, 
  200, 190) - координаты области, где строится диаграмма </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">ActiveSheet.ChartObjects.Add(195, 
  30, 200, 190).Select<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Построение 
  диаграммы </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveChart.ChartWizard 
  Source:=<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Range(Cells(1, 
  2), Cells(2, n)),<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Gallery:=ТипГрафика, 
  Format:=Формат,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">PlotBy:=xlRows, 
  CategoryLabels:=l,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">SeriesLabels:=0, 
  HasLegend:=False,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Title:=&quot;Диаграмма&quot;, 
  CategoryTitle:=&quot;Cтaвкa&quot;,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ValueTitle:=&quot;Выплаты&quot;, 
  ExtraTitle:=&quot;&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButton2_Click()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  закрытия диалогового окна</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">UserForml.Hide 
  End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  CommandButton3_Click()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  очистки рабочего листа </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveSheet.ChartObjects.Delete<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Очистка ячеек 
  рабочего листа<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">ActiveSheet.Cells(1,1).CurrentRegion.Clear<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  OptionButtonl_Click()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  загрузки файла в элемент управления Image<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' при выборе 
  переключателя Гистограмма </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">On Error</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> GoTo Сообщение1<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Imagel.Picture 
  = LoadPicture(&quot;VBA3_F1.BMP&quot;)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Exit Sub </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' В случае отсутствия 
  файла с рисунком отображается сообщение </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Сообщение1:<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If Err.Number 
  = 52 Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Нет 
  графического файла VBA3_F1.BMP.&quot; &amp; Chr'(13) &amp;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">&quot;Работаем 
  без картинки&quot;, vbCritical, &quot;Выплаты&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End If </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Resume Next </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End Sub <BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  OptionButton2_Click()</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  загрузки .файла в элемент управления Image </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">' при выборе 
  переключателя График<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">On Error GoTo 
  Сообщение2 </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Imagel.Picture 
  = LoadPicture(&quot;VBA3_F2.BMP&quot;)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Exit Sub </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' В случае отсутствия 
  файла с рисунком отображается сообщение </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Сообщение2:<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If Err.Number 
  = 52 Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Нет 
  графического файла VBA3_F2.BMP.&quot; &amp; Chr(13) &amp;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">&quot;Работаем 
  без картинки&quot;, vbCritical, &quot;Выплаты&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End If<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Resume Next 
  '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  OptionButton3_Click()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  загрузки файла в элемент управления Image </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">' при выборе 
  переключателя Круговая<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">On Error GoTo 
  СообщениеЗ </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Imagel.Picture 
  = LoadPicture(&quot;VBA3_F3.BMP&quot;)<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' В случае отсутствия 
  файла с рисунком отображается сообщение<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Exit Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Сообщение3:<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If Err.Number 
  = 52 Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Нет 
  графического файла VBA3_F3.BMP.&quot; &amp; Chr(13) &amp;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">&quot;Работаем 
  без картинки&quot;, vbCritical, &quot;Выплаты&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End If<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Resume Next 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Private Sub 
  UserForm_Initialize()<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Процедура 
  инициализации и активизации диалогового окна </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Первоначальный 
  выбор переключателя Гистограмма </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">OptionButtonl.Value 
  = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Назначение 
  клавише &lt;Enter&gt; функции кнопки Вычислить</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With CommandButtonl<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Default = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.ControlTipText 
  = &quot;Вьмисления и составление отчета на рабочем листе&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End With<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">With CommandButton2<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Cancel = True<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.ControlTipText 
  = &quot;Кнопка отмены&quot;</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End with<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">CommandButton3. 
  </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">.ControlTipText 
  = &quot;Очистка рабочего листа&quot;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">On Error</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> GoTo Сообщение0</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> With Image1<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Установка 
  такого же цвета границы элемента управления Image,<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' как и его 
  фон<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.BorderColor 
  = .BackColor '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' Загрузка рисунка 
  соответствующего переключателю Гистограмма </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">.Picture = LoadPicture(&quot;VBA3_F1.BMP&quot;)</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> End With </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">'<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">UserForml.Show<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Exit Sub '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">' В случае отсутствия 
  файла с рисунком, отображается сообщение</font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3"> '<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">Сообщение0:<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">If Err.Number 
  = 52 Then<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">MsgBox &quot;Нет 
  графического файла VBA3_F1.BMP.&quot; <I>&amp; </I>Chr(13) &amp;<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">&quot;Работаем 
  без картинки&quot;, vbCritical, &quot;Выплаты&quot; </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">End If </font></P>
<P align="left"><font face="Courier New, Courier, mono" size="3">Resume Next<BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3">End Sub</font><font face="Times New Roman, Times, serif" size="3"><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">При разработке 
  данного приложения может возникнуть только одно затруднение: Откуда взять подходящие 
  картинки, отображаемые в группе диаграмма диалогового окна Периодических выплат?<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Но, к счастью, 
  это только кажущаяся, можно сказать виртуальная, загвоздка. Эти картинки присутствуют 
  в диалоговом окне первого шага мастера диаграмм. Таким образом, задача сводится 
  к простому экстрагированию их оттуда. Для этого достаточно:<BR>
  </font></P>
<ol>
  <li> <font face="Times New Roman, Times, serif" size="3">Выбрать команду <B>Вставка, 
    Диаграмма </B>(Insert, Chart).<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> В появившемся диалоговом 
    окне первого шага мастера диаграмм при помощи списков Тип (Chart type) и Вид 
    (Chart sub-type) отобразить требуемый рисунок диаграммы.<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Нажать клавишу &lt;Print 
    Screen&gt;, тем самым копируя содержимое экрана в буфер обмена.<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Вызвать какой-нибудь 
    графический редактор. Лучше всего тот, к которому вы привыкли и имеете опыт 
    работы с ним. Если у вас нет никаких особых привязаностей к конкретному графическому 
    редактору, вызовите, например, редактор Paint, который входит в стандартный 
    комплект программ, поставляемых с Windows. Он, конечно, слабоват и обладает 
    не ахти какими возможностями, но их с лихвой хватает для решаемой нами задачи. 
    Для вызова редактора Paint выберите в Windows команду <B>Пуск, Программы, 
    Стандартные, Графический редактор Paint </B>(Start, Programs, Accessories, 
    Paint).<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Появится окно редактора 
    Paint. Нажмите комбинацию клавиш &lt;Ctrl&gt;+&lt;V&gt;, что приведет к вставке 
    в редактор Paint графического образа экрана, скопированного ранее в буфер 
    обмена.<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Нас интересует картинка 
    не всего экрана, а только часть, где изображен выбранный нами тип диаграммы. 
    Этот тип надо выделить - нажмите кнопку <B>Выделение </B>(Selection), а потом 
    при нажатой правой кнопке мыши выделите требуемый фрагмент.<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Нажмите комбинацию 
    клавиш &lt;Ctrl&gt;+&lt;C&gt;. Выделенный фрагмент будет записан в буфер обмена.<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Выберите команду <B>Файл, 
    Создать </B>(File, New). Так как, скорее всего, графическая копия всего экрана 
    нам больше не потребуется, в появившемся диалоговом окне редактора Paint с 
    информационном сообщением о том, надо ли сохранять файл, нажмите кнопку Нет 
    (No).<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Появится пустое окно 
    редактора Paint. Нажмите комбинацию клавиш &lt;Ctrl&gt;+&lt;V&gt;, что приведет 
    к вставке в редактор Paint графического образа вырезанного фрагмента экрана, 
    скопированного ранее в буфер обмена.<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3"> Используя команду 
    <B>Рисунок, Атрибуты </B>(Image, Attributes) или маркеры изменения размера 
    рисунка, можно подобрать размеры рисунка так, чтобы они совпадали со вставленным 
    в редактор фрагментом экрана.<BR>
    </font></li>
  <li> <font face="Times New Roman, Times, serif" size="3">Выберите команду <B>Файл, 
    Сохранить как </B>(File, Save as) для того, чтобы сохранить созданный графический 
    файл на диске.<BR>
    </font></li>
</ol>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><B><font size="4"><a name="5"></a>Самостоятельное 
  задание</font></B><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">Построить 
  приложение с диалоговым окном диаграмма (рис. У9.4). В этом приложении протабулировать 
  следующие функции на заданном интервале с заданным шагом:<BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3"><I><font face="Courier New, Courier, mono">F(x) 
  = х<SUP>2</SUP>Sin(</font></I><font face="Courier New, Courier, mono">л</font><I><font face="Courier New, Courier, mono"> 
  х)</font></I><font face="Courier New, Courier, mono"><BR>
  </font></font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3"><I>G(x) = </I>Sin<SUP>2</SUP>(л 
  <I>x) </I>Cos(л <I>x)</I><BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3"><I>T(x) </I>= 
  (Sin(л x)+Cos(л <I>x)) /</I>(<i>1</i> + Sin<SUP>2</SUP>(л <I>x))</I><BR>
  </font></P>
<P align="left"> <font face="Courier New, Courier, mono" size="3"><I>U(x) </I>= 
  Sin<SUP>3</SUP>(л <I>x)Cos(л x)(1 + </I>Sin<SUP>2</SUP>(л <I>x))</I></font><font face="Times New Roman, Times, serif" size="3"><BR>
  </font></P>
<P align="left"><img src="9.4.gif" width="519" height="272"> </P>
<P align="left"><font face="Times New Roman, Times, serif" size="3"><B><I>Рис. 
  У9.4. </I></B><I>Диалоговое окно Диаграмма</I><BR>
  </font></P>
<P align="left"> <font face="Times New Roman, Times, serif" size="3">При этом 
  должны табулироваться не все функции, а только выбранные в списке выбираемые 
  функции. Для отображения списка с флажками, которые позволят более наглядно 
  выбирать несколько элементов из списка, воспользуйтесь свойством списка Liststyle. 
  Результат табуляции следует вывести в список Аргумент и значения функций. Для 
  того чтобы все табулируемые значения поместились в этот список по ширине, воспользуйтесь 
  свойством ColumnWidths, которое устанавливает ширину каждой колонки списка. 
  По результату табуляции программа должна построить диаграмму, выбранную из группы 
  Диаграмма.</font></P>
</BODY>
</HTML>

